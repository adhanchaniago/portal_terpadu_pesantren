<?php
/*
 * Generated by CRUDigniter v3.2
 * www.crudigniter.com
 */
class Datamaster extends CI_Controller{
    function __construct()
    {
        parent::__construct();
        $this->load->library(array('form_validation','session'));
        $this->load->model('back-end/datamaster/m_admin');
        $this->load->model('back-end/datamaster/m_santri');
        $this->load->model('back-end/datamaster/m_santriwati');
        $this->load->model('back-end/datamaster/m_guru');
        $this->load->model('back-end/datamaster/m_staff');
        $this->load->model('back-end/datamaster/m_provinsi');
        $this->load->model('back-end/datamaster/m_pendidikan');
        $this->load->model('back-end/datamaster/m_pekerjaan');
        $this->load->model('back-end/datamaster/m_alat_transportasi');
        $this->load->model('back-end/datamaster/m_kota_kab');
        $this->load->model('back-end/datamaster/m_kecamatan');
        $this->load->model('back-end/datamaster/m_kel_desa');
        $this->load->model('back-end/datamaster/m_tahun_ajaran');
        $this->load->model('back-end/datamaster/m_kelas');
        $this->load->model('back-end/datamaster/m_matpel');
        $this->load->model('back-end/datamaster/m_pelajaran');
        $this->load->model('back-end/datamaster/m_infaq');
        $this->load->model('back-end/datamaster/m_presensi');
        $this->load->model('back-end/datamaster/m_prestasi');
        $this->load->model('back-end/datamaster/m_pelanggaran');
        $this->load->model('back-end/datamaster/m_jenjang');
        $this->load->model('back-end/datamaster/m_pondokan');
        $this->load->model('back-end/datamaster/m_presensipondokan');
        $this->load->model('back-end/datamaster/m_rekap_santri');
        $this->load->model('back-end/datamaster/m_rekap_santri_pondokan');
        $this->load->model('back-end/datamaster/m_rekap_guru');
        $this->load->model('back-end/datamaster/m_rekap_guru_pondokan');
        $this->load->model('back-end/datamaster/m_akun_ortu');
        $this->load->model('back-end/datamaster/m_pak_pondokan');
        $this->load->model('back-end/datamaster/m_pak_afilasi');
        $this->load->model('back-end/datamaster/m_informasi');
        $this->load->library('layout');
        $this->load->helper('indo_helper');
        if ($this->session->userdata('nama_akun')=="") {
            redirect('admin/login');
        }
        else if ($this->session->userdata('kode_role_admin') == 'adm_pd') {
            redirect('admin/pendaftaran');
        }
        else if ($this->session->userdata('kode_role_admin') == 'adm_prz') {
            redirect('admin/perizinan');
        }
        $this->load->helper('text');
    }


    function index()
    {
        $variabel['nama_akun'] = $this->session->userdata('nama_akun');
        $this->layout->render('back-end/datamaster/dashboard',$variabel);
    }

    function logout(){
        $this->session->unset_userdata('nip_staff_admin');
        $this->session->unset_userdata('nama_akun');
        $this->session->unset_userdata('kode_role_admin');
        session_destroy();
        redirect('admin/login');
    }

    // CRUD Admin
    function admin(){
       $variabel['data'] = $this->m_admin->lihatdata();
       $this->layout->render('back-end/datamaster/admin/v_admin',$variabel,'back-end/datamaster/admin/v_admin_js');
    }

    function admintambah(){
        if ($this->input->post()){
            $array=array(
                'kode_role_admin'=> $this->input->post('kode_role_admin'),
                'nip_staff_admin'=> $this->input->post('nip_staff_admin'),
                'nama_akun'=> $this->input->post('nama_akun'),
                'kata_sandi'=> md5($this->input->post('kata_sandi')),
                );
            $nama_akun = $this->input->post("nama_akun");
            $kata_sandi = $this->input->post("kata_sandi");
            $rekata_sandi = $this->input->post("rekata_sandi");
            if (($this->m_admin->cekdata($nama_akun)==0) && ($kata_sandi==$rekata_sandi)) {
                $exec = $this->m_admin->tambahdata($array);
                if ($exec) redirect(base_url("admin/datamaster/admintambah?msg=1"));
                else redirect(base_url("admin/datamaster/admintambah?msg=0"));
            } else if ($kata_sandi!=$rekata_sandi) {
                $variabel['nip_staff_admin']=$this->m_admin->ambilstaff();
                $variabel['kode_role_admin']=$this->m_admin->ambilroleadmin();
                $variabel['rekata_sandi'] =$this->input->post("rekata_sandi");
                $this->layout->render('back-end/datamaster/admin/v_admin_tambah',$variabel,'back-end/datamaster/admin/v_admin_js');
            }
            else {
                $variabel['nip_staff_admin']=$this->m_admin->ambilstaff();
                $variabel['kode_role_admin']=$this->m_admin->ambilroleadmin();
                $variabel['nama_akun'] =$this->input->post('nama_akun');
                $this->layout->render('back-end/datamaster/admin/v_admin_tambah',$variabel,'back-end/datamaster/admin/v_admin_js');
            }
        } else {
            //$variabel ='';
            $variabel['nip_staff_admin']=$this->m_admin->ambilstaff();
            $variabel['kode_role_admin']=$this->m_admin->ambilroleadmin();
            $this->layout->render('back-end/datamaster/admin/v_admin_tambah',$variabel,'back-end/datamaster/admin/v_admin_js');
        }
    }

    function adminedit(){
        if ($this->input->post()) {
          $array=array(
              'nama_role'=> $this->input->post('nama_role'),
              'nip_staff_admin'=> $this->input->post('nip_staff_admin'),
              'nama_lengkap'=> $this->input->post('nama_lengkap'),
              'nama_akun'=> $this->input->post('nama_akun'),
              'kata_sandi'=> $this->input->post('kata_sandi'),
              );
            $nama_akun = $this->input->post("nama_akun");
            $kata_sandi = md5($this->input->post("kata_sandi"));
            $kata_sandibr = md5($this->input->post("kata_sandibr"));
            $rekata_sandibr = md5($this->input->post("rekata_sandibr"));
            $query = $this->m_admin->cekdataedit($nama_akun);
            if ($query->kata_sandi!=$kata_sandi) {
                $variabel['kata_sandi'] =$this->input->post('kata_sandi');
                $variabel['data'] = $array;
                $this->layout->render('back-end/datamaster/admin/v_admin_edit',$variabel,'back-end/datamaster/admin/v_admin_js');
            } else if ($kata_sandibr!=$rekata_sandibr){
                 $variabel['rekata_sandibr'] =$this->input->post('rekata_sandibr');
                 $variabel['data'] = $array;
                 $this->layout->render('back-end/datamaster/admin/v_admin_edit',$variabel,'back-end/datamaster/admin/v_admin_js');
            } else {
                $exec = $this->m_admin->editdata($nama_akun,$kata_sandi,$kata_sandibr);
                if ($exec){
                    redirect(base_url("admin/datamaster/adminedit?nama_akun=".$nama_akun."&msg=1"));
                }
            }
        } else {
            $nama_akun = $this->input->get("nama_akun");
            $exec = $this->m_admin->lihatdatasatu($nama_akun);
            if ($exec->num_rows()>0){
                $variabel['data'] = $exec ->row_array();
                $this->layout->render('back-end/datamaster/admin/v_admin_edit',$variabel,'back-end/datamaster/admin/v_admin_js');
            } else {
                redirect(base_url("admin/datamaster/admin"));
            }
        }
    }

    function adminhapus(){
        $nama_akun = $this->input->get("nama_akun");
        $exec = $this->m_admin->hapus($nama_akun);
        redirect(base_url()."admin/datamaster/admin?msg=1");
    }
    // End CRUD Admin
    // CRUD santriwati
    function santriwati()
    {
        $variabel['data'] = $this->m_santriwati->lihatdata();
        $this->layout->render('back-end/datamaster/santriwati/v_santri',$variabel,'back-end/datamaster/santriwati/v_santri_js');
    }
    function santriwatilihat()
    {
        $nis = $this->input->get("nis");
        $exec = $this->m_santriwati->lihatdatasatu($nis);
        if ($exec->num_rows()>0){
            $variabel['data'] = $exec ->row_array();
            $variabel['tingkat'] = $this->m_santriwati->lihattingkatan($nis); ;
            $variabel['tingkatpondokan'] = $this->m_santriwati->lihattingkatanpondokan($nis); ;
            $this->layout->render('back-end/datamaster/santriwati/v_santri_lihat',$variabel,'back-end/datamaster/santriwati/v_santri_js');
        } else {
            redirect(base_url("admin/datamaster/santriwati"));
        }

    }

    function santriwatitingkat()
    {
        $nis = $this->input->post("nis");
        $variabel['tingkat'] = $this->m_santriwati->lihattingkatan($nis);
        $this->load->view('back-end/datamaster/santriwati/v_santri_tingkat',$variabel);
    }

    function santriwatitingkatpondokan()
    {
        $nis = $this->input->post("nis");
        $variabel['tingkat'] = $this->m_santriwati->lihattingkatanpondokan($nis);
        $this->load->view('back-end/datamaster/santriwati/v_santri_tingkatpondokan',$variabel);
    }




    function santriwatitambah()
    {
        if ($this->input->post()){
                $array=array(
                    'nis_lokal'=> $this->input->post('nis_lokal'),
                    'email_santri'=> $this->input->post('email_santri'),
                    'nisn'=> $this->input->post('nisn'),
                    'nik'=> $this->input->post('nik'),
                    'nama_lengkap'=>$this->input->post('nama_lengkap'),
                    'tempat_lahir'=>$this->input->post('tempat_lahir'),
                    'tgl_lahir'=>tanggalawal($this->input->post('tgl_lahir')),
                    'jenis_kelamin'=>$this->input->post('jenis_kelamin'),
                    'alamat_lengkap'=>$this->input->post('alamat_lengkap'),
                    'provinsi'=>$this->input->post('provinsi'),
                    'kabupaten_kota'=>$this->input->post('kabupaten_kota'),
                    'kecamatan'=>$this->input->post('kecamatan'),
                    'desa_kelurahan'=>$this->input->post('desa_kelurahan'),
                    'kode_pos'=>$this->input->post('kode_pos'),
                    'hobi'=>$this->input->post('hobi'),
                    'cita_cita'=>$this->input->post('cita_cita'),
                    'jenis_sekolah_asal'=>$this->input->post('jenis_sekolah_asal'),
                    'status_sekolah_asal'=>$this->input->post('status_sekolah_asal'),
                    'nomor_peserta_ujian'=>$this->input->post('nomor_peserta_ujian'),
                    'jarak_ke_sekolah'=>$this->input->post('jarak_ke_sekolah'),
                    'alat_transportasi'=>$this->input->post('alat_transportasi'),
                    'status_tempat_tinggal'=>$this->input->post('status_tempat_tinggal'),
                    'no_kk'=>$this->input->post('no_kk'),
                    'nik_ayah'=>$this->input->post('nik_ayah'),
                    'nama_lengkap_ayah'=>$this->input->post('nama_lengkap_ayah'),
                    'pendidikan_terakhir_ayah'=>$this->input->post('pendidikan_terakhir_ayah'),
                    'pekerjaan_ayah'=>$this->input->post('pekerjaan_ayah'),
                    'nik_ibu'=>$this->input->post('nik_ibu'),
                    'nama_lengkap_ibu'=>$this->input->post('nama_lengkap_ibu'),
                    'pendidikan_terakhir_ibu'=>$this->input->post('pendidikan_terakhir_ibu'),
                    'pekerjaan_ibu'=>$this->input->post('pekerjaan_ibu'),
                    'penghasilan_orang_tua'=>$this->input->post('penghasilan_orang_tua'),
                    'nik_wali'=>$this->input->post('nik_wali'),
                    'nama_lengkap_wali'=>$this->input->post('nama_lengkap_wali'),
                    'pendidikan_terakhir_wali'=>$this->input->post('pendidikan_terakhir_wali'),
                    'pekerjaan_wali'=>$this->input->post('pekerjaan_wali'),
                    'penghasilan_wali'=>$this->input->post('penghasilan_wali'),
                    'jumlah_saudara_kandung'=>$this->input->post('jumlah_saudara_kandung'),
                    'hp'=>$this->input->post('hp'),
                    'hpayah'=>$this->input->post('hpayah'),
                    'hpibu'=>$this->input->post('hpibu'),
                    'hpwali'=>$this->input->post('hpwali'),
                    'kelas'=>$this->input->post('kelas'),
                    'pondokan'=>$this->input->post('pondokan')
                    );
            if ($this->m_santriwati->cekdata($this->input->post('nis_lokal'))==0) {
                $config['upload_path'] = './assets/images/foto';
                $config['allowed_types'] = 'jpg|jpeg|JPG|JPEG|PNG|png';
                $this->load->library('upload', $config);
                $this->upload->do_upload("foto");
                $upload = $this->upload->data();
                $foto = $upload["raw_name"].$upload["file_ext"];
                $array['foto']=$foto;
                $exec = $this->m_santriwati->tambahdata($array);
                if ($exec) redirect(base_url("admin/datamaster/santriwatitambah?msg=1"));
                else redirect(base_url("admin/datamaster/santriwatitambah?msg=0"));
            } else {
                $variabel['provinsi']=$this->m_santriwati->ambilprovinsi();
                $variabel['kabupaten']=$this->m_santriwati->ambilkabupaten($this->input->post('provinsi'));
                $variabel['kecamatan']=$this->m_santriwati->ambilkecamatan($this->input->post('kabupaten_kota'));
                $variabel['desa']=$this->m_santriwati->ambildesa($this->input->post('kecamatan'));
                $variabel['transportasi']=$this->m_santriwati->ambiltransportasi();
                $variabel['pekerjaan']=$this->m_santriwati->ambilpekerjaan();
                $variabel['pendidikan']=$this->m_santriwati->ambilpendidikan();
                $variabel['nis_lokal'] =$this->input->post('nis_lokal');
                $variabel['jenjang']=$this->m_jenjang->lihatdata();
                $variabel['pondokan']=$this->m_pondokan->lihatdata();
                $this->layout->render('back-end/datamaster/santriwati/v_santri_tambah',$variabel,'back-end/datamaster/santriwati/v_santri_js');
            }

        } else {
             $variabel['provinsi']=$this->m_santri->ambilprovinsi();
             $variabel['transportasi']=$this->m_santri->ambiltransportasi();
             $variabel['pekerjaan']=$this->m_santri->ambilpekerjaan();
             $variabel['pendidikan']
             =$this->m_santri->ambilpendidikan();
             $variabel['kabupaten']=$this->m_santri->ambilkabupaten("");
             $variabel['kecamatan']=$this->m_santri->ambilkecamatan("");
             $variabel['desa']=$this->m_santri->ambildesa("");
             $variabel['jenjang']=$this->m_jenjang->lihatdata();
             $variabel['pondokan']=$this->m_pondokan->lihatdata();

            $this->layout->render('back-end/datamaster/santri/v_santri_tambah',$variabel,'back-end/datamaster/santri/v_santri_js');
        }
    }

    //

    // CRUD Santri
    function santri()
    {
        $variabel['data'] = $this->m_santri->lihatdata();
        $this->layout->render('back-end/datamaster/santri/v_santri',$variabel,'back-end/datamaster/santri/v_santri_js');
    }

    function santrilihat()
    {
        $nis = $this->input->get("nis");
        $exec = $this->m_santri->lihatdatasatu($nis);
        if ($exec->num_rows()>0){
            $variabel['data'] = $exec ->row_array();
            $variabel['tingkat'] = $this->m_santri->lihattingkatan($nis); ;
            $variabel['tingkatpondokan'] = $this->m_santri->lihattingkatanpondokan($nis); ;
            $this->layout->render('back-end/datamaster/santri/v_santri_lihat',$variabel,'back-end/datamaster/santri/v_santri_js');
        } else {
            redirect(base_url("admin/datamaster/santri"));
        }

    }

    function santritingkat()
    {
        $nis = $this->input->post("nis");
        $variabel['tingkat'] = $this->m_santri->lihattingkatan($nis);
        $this->load->view('back-end/datamaster/santri/v_santri_tingkat',$variabel);
    }

    function santritingkatpondokan()
    {
        $nis = $this->input->post("nis");
        $variabel['tingkat'] = $this->m_santri->lihattingkatanpondokan($nis);
        $this->load->view('back-end/datamaster/santri/v_santri_tingkatpondokan',$variabel);
    }

    function datakotakab2()
    {
      $id=$this->input->post('provinsi');
      $data=$this->m_santri->datakotaajax($id);
      echo json_encode($data);
    }

    function datakecamatan2()
    {
      $id=$this->input->post('kecamatan');
      $data=$this->m_santri->datakecamatanajax($id);
      echo json_encode($data);
    }

    function datadesa2()
    {
      $id=$this->input->post('desa');
      $data=$this->m_santri->datadesaajax($id);
      echo json_encode($data);
    }


    function santritambah()
    {
        if ($this->input->post()){
                $array=array(
                    'nis_lokal'=> $this->input->post('nis_lokal'),
                    'email_santri'=> $this->input->post('email_santri'),
                    'nisn'=> $this->input->post('nisn'),
                    'nik'=> $this->input->post('nik'),
                    'nama_lengkap'=>$this->input->post('nama_lengkap'),
                    'tempat_lahir'=>$this->input->post('tempat_lahir'),
                    'tgl_lahir'=>tanggalawal($this->input->post('tgl_lahir')),
                    'jenis_kelamin'=>$this->input->post('jenis_kelamin'),
                    'alamat_lengkap'=>$this->input->post('alamat_lengkap'),
                    'provinsi'=>$this->input->post('provinsi'),
                    'kabupaten_kota'=>$this->input->post('kabupaten_kota'),
                    'kecamatan'=>$this->input->post('kecamatan'),
                    'desa_kelurahan'=>$this->input->post('desa_kelurahan'),
                    'kode_pos'=>$this->input->post('kode_pos'),
                    'hobi'=>$this->input->post('hobi'),
                    'cita_cita'=>$this->input->post('cita_cita'),
                    'jenis_sekolah_asal'=>$this->input->post('jenis_sekolah_asal'),
                    'status_sekolah_asal'=>$this->input->post('status_sekolah_asal'),
                    'nomor_peserta_ujian'=>$this->input->post('nomor_peserta_ujian'),
                    'jarak_ke_sekolah'=>$this->input->post('jarak_ke_sekolah'),
                    'alat_transportasi'=>$this->input->post('alat_transportasi'),
                    'status_tempat_tinggal'=>$this->input->post('status_tempat_tinggal'),
                    'no_kk'=>$this->input->post('no_kk'),
                    'nik_ayah'=>$this->input->post('nik_ayah'),
                    'nama_lengkap_ayah'=>$this->input->post('nama_lengkap_ayah'),
                    'pendidikan_terakhir_ayah'=>$this->input->post('pendidikan_terakhir_ayah'),
                    'pekerjaan_ayah'=>$this->input->post('pekerjaan_ayah'),
                    'nik_ibu'=>$this->input->post('nik_ibu'),
                    'nama_lengkap_ibu'=>$this->input->post('nama_lengkap_ibu'),
                    'pendidikan_terakhir_ibu'=>$this->input->post('pendidikan_terakhir_ibu'),
                    'pekerjaan_ibu'=>$this->input->post('pekerjaan_ibu'),
                    'penghasilan_orang_tua'=>$this->input->post('penghasilan_orang_tua'),
                    'nik_wali'=>$this->input->post('nik_wali'),
                    'nama_lengkap_wali'=>$this->input->post('nama_lengkap_wali'),
                    'pendidikan_terakhir_wali'=>$this->input->post('pendidikan_terakhir_wali'),
                    'pekerjaan_wali'=>$this->input->post('pekerjaan_wali'),
                    'penghasilan_wali'=>$this->input->post('penghasilan_wali'),
                    'jumlah_saudara_kandung'=>$this->input->post('jumlah_saudara_kandung'),
                    'hp'=>$this->input->post('hp'),
                    'hpayah'=>$this->input->post('hpayah'),
                    'hpibu'=>$this->input->post('hpibu'),
                    'hpwali'=>$this->input->post('hpwali'),
                    'kelas'=>$this->input->post('kelas'),
                    'pondokan'=>$this->input->post('pondokan')
                    );
            if ($this->m_santri->cekdata($this->input->post('nis_lokal'))==0) {
                $config['upload_path'] = './assets/images/foto';
                $config['allowed_types'] = 'jpg|jpeg|JPG|JPEG|PNG|png';
                $this->load->library('upload', $config);
                $this->upload->do_upload("foto");
                $upload = $this->upload->data();
                $foto = $upload["raw_name"].$upload["file_ext"];
                $array['foto']=$foto;
                $exec = $this->m_santri->tambahdata($array);
                if ($exec) redirect(base_url("admin/datamaster/santritambah?msg=1"));
                else redirect(base_url("admin/datamaster/santritambah?msg=0"));
            } else {
                $variabel['provinsi']=$this->m_santri->ambilprovinsi();
                $variabel['kabupaten']=$this->m_santri->ambilkabupaten($this->input->post('provinsi'));
                $variabel['kecamatan']=$this->m_santri->ambilkecamatan($this->input->post('kabupaten_kota'));
                $variabel['desa']=$this->m_santri->ambildesa($this->input->post('kecamatan'));
                $variabel['transportasi']=$this->m_santri->ambiltransportasi();
                $variabel['pekerjaan']=$this->m_santri->ambilpekerjaan();
                $variabel['pendidikan']=$this->m_santri->ambilpendidikan();
                $variabel['nis_lokal'] =$this->input->post('nis_lokal');
                $variabel['jenjang']=$this->m_jenjang->lihatdata();
                $variabel['pondokan']=$this->m_pondokan->lihatdata();
                $this->layout->render('back-end/datamaster/santri/v_santri_tambah',$variabel,'back-end/datamaster/santri/v_santri_js');
            }

        } else {
             $variabel['provinsi']=$this->m_santri->ambilprovinsi();
             $variabel['transportasi']=$this->m_santri->ambiltransportasi();
             $variabel['pekerjaan']=$this->m_santri->ambilpekerjaan();
             $variabel['pendidikan']
             =$this->m_santri->ambilpendidikan();
             $variabel['kabupaten']=$this->m_santri->ambilkabupaten("");
             $variabel['kecamatan']=$this->m_santri->ambilkecamatan("");
             $variabel['desa']=$this->m_santri->ambildesa("");
             $variabel['jenjang']=$this->m_jenjang->lihatdata();
             $variabel['pondokan']=$this->m_pondokan->lihatdata();

            $this->layout->render('back-end/datamaster/santri/v_santri_tambah',$variabel,'back-end/datamaster/santri/v_santri_js');
        }
    }

    function santriedit()
    {
        if ($this->input->post()) {
            $array=array(
                'nis_lokal'=> $this->input->post('nis_lokal'),
                'email_santri'=> $this->input->post('email_santri'),
                'nisn'=> $this->input->post('nisn'),
                'nik'=> $this->input->post('nik'),
                'nama_lengkap'=>$this->input->post('nama_lengkap'),
                'tempat_lahir'=>$this->input->post('tempat_lahir'),
                'tgl_lahir'=>tanggalawal($this->input->post('tgl_lahir')),
                'jenis_kelamin'=>$this->input->post('jenis_kelamin'),
                'alamat_lengkap'=>$this->input->post('alamat_lengkap'),
                'provinsi'=>$this->input->post('provinsi'),
                'kabupaten_kota'=>$this->input->post('kabupaten_kota'),
                'kecamatan'=>$this->input->post('kecamatan'),
                'desa_kelurahan'=>$this->input->post('desa_kelurahan'),
                'kode_pos'=>$this->input->post('kode_pos'),
                'hobi'=>$this->input->post('hobi'),
                'cita_cita'=>$this->input->post('cita_cita'),
                'jenis_sekolah_asal'=>$this->input->post('jenis_sekolah_asal'),
                'status_sekolah_asal'=>$this->input->post('status_sekolah_asal'),
                'nomor_peserta_ujian'=>$this->input->post('nomor_peserta_ujian'),
                'jarak_ke_sekolah'=>$this->input->post('jarak_ke_sekolah'),
                'alat_transportasi'=>$this->input->post('alat_transportasi'),
                'status_tempat_tinggal'=>$this->input->post('status_tempat_tinggal'),
                'no_kk'=>$this->input->post('no_kk'),
                'nik_ayah'=>$this->input->post('nik_ayah'),
                'nama_lengkap_ayah'=>$this->input->post('nama_lengkap_ayah'),
                'pendidikan_terakhir_ayah'=>$this->input->post('pendidikan_terakhir_ayah'),
                'pekerjaan_ayah'=>$this->input->post('pekerjaan_ayah'),
                'nik_ibu'=>$this->input->post('nik_ibu'),
                'nama_lengkap_ibu'=>$this->input->post('nama_lengkap_ibu'),
                'pendidikan_terakhir_ibu'=>$this->input->post('pendidikan_terakhir_ibu'),
                'pekerjaan_ibu'=>$this->input->post('pekerjaan_ibu'),
                'penghasilan_orang_tua'=>$this->input->post('penghasilan_orang_tua'),
                'nik_wali'=>$this->input->post('nik_wali'),
                'nama_lengkap_wali'=>$this->input->post('nama_lengkap_wali'),
                'pendidikan_terakhir_wali'=>$this->input->post('pendidikan_terakhir_wali'),
                'pekerjaan_wali'=>$this->input->post('pekerjaan_wali'),
                'penghasilan_wali'=>$this->input->post('penghasilan_wali'),
                'jumlah_saudara_kandung'=>$this->input->post('jumlah_saudara_kandung'),
                'hp'=>$this->input->post('hp'),
                'hpayah'=>$this->input->post('hpayah'),
                'hpibu'=>$this->input->post('hpibu'),
                'hpwali'=>$this->input->post('hpwali'),
                'kelas'=>$this->input->post('kelas'),
                'pondokan'=>$this->input->post('pondokan')
                );
            $nis2 = $this->input->post("nis_lokal2");
            $nis = $this->input->post("nis_lokal");
            if (($this->m_santri->cekdata($nis)>0) && ($nis2!=$nis)) {
                $variabel['nis_lokal'] =$this->input->post('nis_lokal');
                $variabel['nis_lokal2'] =$this->input->post('nis_lokal2');
                $variabel['data'] = $array;

                $variabel['provinsi']=$this->m_santri->ambilprovinsi();
                $variabel['kabupaten']=$this->m_santri->ambilkabupaten($this->input->post('provinsi'));
                $variabel['kecamatan']=$this->m_santri->ambilkecamatan($this->input->post('kabupaten_kota'));
                $variabel['desa']=$this->m_santri->ambildesa($this->input->post('kecamatan'));

                $variabel['transportasi']=$this->m_santri->ambiltransportasi();
                $variabel['pekerjaan']=$this->m_santri->ambilpekerjaan();
                $variabel['pendidikan']=$this->m_santri->ambilpendidikan();
                $variabel['jenjang']=$this->m_jenjang->lihatdata();
                $variabel['pondokan']=$this->m_pondokan->lihatdata();

                $this->layout->render('back-end/datamaster/santri/v_santri_edit',$variabel,'back-end/datamaster/santri/v_santri_js');
            } else {
                $config['upload_path'] = './assets/images/foto';
                $config['allowed_types'] = 'jpg|jpeg|JPG|JPEG|pdf|PNG|png';
                $this->load->library('upload', $config);
                if ($this->upload->do_upload("foto"))
                {
                    $upload = $this->upload->data();
                    $foto = $upload["raw_name"].$upload["file_ext"];
                    $array['foto']=$foto;

                    $query2 = $this->m_santri->lihatdatasatu($nis2);
                    $row2 = $query2->row();
                    $berkas1temp = $row2->foto;
                    $path1 ='./assets/images/foto/'.$berkas1temp.'';
                    echo "$path1";
                    if(is_file($path1)) {
                        unlink($path1); //menghapus gambar di folder produk
                    }
                }
                $exec = $this->m_santri->editdata($nis2,$array);
                if ($exec){
                  redirect(base_url("admin/datamaster/santriedit?nis=".$nis."&msg=1"));
                }
            }
      } else {
            $nis = $this->input->get("nis");
            $exec = $this->m_santri->lihatdatasatu($nis);
            if ($exec->num_rows()>0){
                $data =  $exec ->row_array();
                $variabel['data'] = $data;

                $variabel['provinsi']=$this->m_santri->ambilprovinsi();
                $variabel['transportasi']=$this->m_santri->ambiltransportasi();
                 $variabel['pekerjaan']=$this->m_santri->ambilpekerjaan();
                 $variabel['pendidikan']
                 =$this->m_santri->ambilpendidikan();

                 $variabel['kabupaten']=$this->m_santri->ambilkabupaten($data['provinsi']);
                 $variabel['kecamatan']=$this->m_santri->ambilkecamatan($data['kabupaten_kota']);
                 $variabel['desa']=$this->m_santri->ambildesa($data['kecamatan']);
                 $variabel['jenjang']=$this->m_jenjang->lihatdata();
                 $variabel['pondokan']=$this->m_pondokan->lihatdata();
                $this->layout->render('back-end/datamaster/santri/v_santri_edit',$variabel,'back-end/datamaster/santri/v_santri_js');
            } else {
                redirect(base_url("admin/datamaster/santri"));
            }
      }

    }

    function santrihapus()
    {
       $nis = $this->input->get("nis");
       $exec = $this->m_santri->hapus($nis);
       redirect(base_url()."admin/datamaster/santri?msg=1");
    }

    function santriberkas()
    {
        $nis = $this->input->get("nis");
        $exec = $this->m_santri->lihatdatasatu($nis);
        if ($exec->num_rows()>0){
            $variabel['santri'] = $exec->row_array();
            $variabel['data'] = $this->m_santri->lihatdataberkas($nis);
            $this->layout->render('back-end/datamaster/santri/v_santriberkas',$variabel,'back-end/datamaster/santri/v_santriberkas_js');
        } else {
            redirect(base_url("admin/datamaster/santri"));
        }

    }

    function santritambahberkas()
    {
        $nis = $this->input->get("nis");
        $exec = $this->m_santri->lihatdatasatu($nis);
        if ($exec->num_rows()>0){
            $variabel['santri'] = $exec->row_array();
            if ($this->input->post()){
                $config['upload_path'] = './assets/berkas/berkassantri';
                $config['allowed_types'] = 'jpg|jpeg|JPG|JPEG|pdf';
                $this->load->library('upload', $config);
                $this->upload->do_upload("file_berkas");
                $upload = $this->upload->data();
                $file_berkas = $upload["raw_name"].$upload["file_ext"];

                $nis_lokal = $this->input->post('nis_lokal');
                $nama_berkas = $this->input->post('nama_berkas');
                $array=array(
                    'nis_lokal'=>  $nis_lokal,
                    'nama_berkas'=> $nama_berkas,
                    'file_berkas' => $file_berkas
                    );

                $exec = $this->m_santri->tambahdataberkas($array);
                if ($exec) redirect(base_url("admin/datamaster/santritambahberkas?nis=".$nis_lokal."&msg=1"));
                else redirect(base_url("admin/datamaster/santriberkastambah?nis=".$nis_lokal."&msg=0"));
            } else {

                $this->layout->render('back-end/datamaster/santri/v_santriberkas_tambah',$variabel,'back-end/datamaster/santri/v_santriberkas_js');
            }
        } else {
            redirect(base_url("admin/datamaster/santri"));
        }
    }

    function santrihapusberkas()
    {
        $id_berkas = $this->input->get("id_berkas");
        $nis = $this->input->get("nis");

        $query2 = $this->m_santri->lihatdatasatuberkas($id_berkas);
        $row2 = $query2->row();
        $berkas1temp = $row2->file_berkas;
        $path1 ="./assets/berkas/berkassantri/".$berkas1temp."";
        if(is_file($path1)) {
            unlink($path1);
        }

        $exec = $this->m_santri->hapusberkas($id_berkas);
        redirect(base_url()."admin/datamaster/santriberkas?msg=1&nis=".$nis."");
    }

    function santrieditberkas()
    {
        if ($this->input->post()) {
            $id_berkas = $this->input->post('id_berkas');
            $nama_berkas = $this->input->post('nama_berkas');
            $nis_lokal = $this->input->post('nis_lokal');
            $array=array(
                'nama_berkas'=> $nama_berkas
                );

            $config['upload_path'] = './assets/berkas/berkassantri';
            $config['allowed_types'] = 'jpg|jpeg|JPG|JPEG|pdf';
            $this->load->library('upload', $config);
            if ( $this->upload->do_upload("file_berkas"))
            {
                $upload = $this->upload->data();
                $file_berkas = $upload["raw_name"].$upload["file_ext"];
                $array['file_berkas']=$file_berkas;

                $query2 = $this->m_santri->lihatdatasatuberkas($id_berkas);
                $row2 = $query2->row();
                $berkas1temp = $row2->file_berkas;
                $path1 ="./assets/berkas/berkassantri/".$berkas1temp."";
                if(is_file($path1)) {
                    unlink($path1); //menghapus gambar di folder produk
                }
            }
            $exec = $this->m_santri->editdataaberkas($id_berkas,$array);
            if ($exec) redirect(base_url("admin/datamaster/santrieditberkas?id=".$id_berkas."&nis=".$nis_lokal."&msg=1"));
            else redirect(base_url("admin/datamaster/santrieditberkas?id=".$id_berkas."&nis=".$nis_lokal."&msg=0"));

        } else {
            $nis = $this->input->get("nis");
            $id = $this->input->get("id");
            $exec = $this->m_santri->lihatdatasatu($nis);
            if ($exec->num_rows()>0){
                $variabel['santri'] = $exec ->row_array();
                $exec2 = $this->m_santri->lihatdatasatuberkas($id);
                if ($exec2->num_rows()>0){

                    $variabel['data'] = $exec2->row_array();
                    $this->layout->render('back-end/datamaster/santri/v_santriberkas_edit',$variabel,'back-end/datamaster/santri/v_santriberkas_js');
                } else {
                    redirect(base_url("admin/datamaster/santriberkas?nis=$nis"));
                }
            } else {
                redirect(base_url("admin/datamaster/santri"));
            }
        }

    }

    // End CRUD Santri

//CRUD Mata Pelajaran
    function matpel(){
         $variabel['data'] = $this->m_matpel->lihatdata();
        $this->layout->render('back-end/datamaster/matpel/v_matpel',$variabel,'back-end/datamaster/matpel/v_matpel_js');
    }

    function matpellihat()
    {
        $id_mata_pelajaran = $this->input->get("id_matpel");
        $exec = $this->m_matpel->lihatdatasatu($id_mata_pelajaran);
        if ($exec->num_rows()>0){
            $variabel['data'] = $exec ->row_array();
            $this->layout->render('back-end/datamaster/matpel/v_matpel_lihat',$variabel,'back-end/datamaster/matpel/v_matpel_js');
        } else {
            redirect(base_url("admin/datamaster/matpel"));
        }
    }
    function matpeltambah()
    {
        if ($this->input->post()){
                $array=array(
                    'id_mata_pelajaran'=> NULL,
                    'nama_mata_pelajaran'=> $this->input->post('nama_matpel'),
                    'tingkat_mata_pelajaran'=> $this->input->post('tingkat_matpel'),
                    'semester_mata_pelajaran'=> $this->input->post('semester_matpel'),
                    'kelas_mata_pelajaran'=> $this->input->post('kelas_matpel')
                    );

                $exec = $this->m_matpel->tambahdata($array);
                if ($exec) redirect(base_url("admin/datamaster/matpeltambah?msg=1"));
                else redirect(base_url("admin/datamaster/matpeltambah?msg=0"));
        } else {
            $variabel ='';
            $this->layout->render('back-end/datamaster/matpel/v_matpel_tambah',$variabel,'back-end/datamaster/matpel/v_matpel_js');
        }
    }

    function matpeledit()
    {
        if ($this->input->post()) {
            $kode = $this->input->post('id_matpel');
            $array=array(
                'nama_mata_pelajaran'=> $this->input->post('nama_matpel'),
                'tingkat_mata_pelajaran'=> $this->input->post('tingkat_matpel'),
                'semester_mata_pelajaran'=> $this->input->post('semester_matpel'),
                'kelas_mata_pelajaran'=> $this->input->post('kelas_matpel')
                );
                $exec = $this->m_matpel->editdata($kode,$array);
                if ($exec)
                  redirect(base_url("admin/datamaster/matpeledit?id_matpel=".$kode."&msg=1"));
                else
                    redirect(base_url("admin/datamaster/matpeledit?id_matpel=".$kode."&msg=0"));
        }
        else{
            $kode = $this->input->get("id_matpel");
            $exec = $this->m_matpel->lihatdatasatu($kode);
            if ($exec->num_rows()>0){
                    $variabel['data'] = $exec ->row_array();
                    $this->layout->render('back-end/datamaster/matpel/v_matpel_edit',$variabel,'back-end/datamaster/matpel/v_matpel_js');
            }
            else
                redirect(base_url("admin/datamaster/matpel"));
        }
    }
    function matpelhapus()
    {
       $kode = $this->input->get("id_matpel");
       $exec = $this->m_matpel->hapus($kode);
       redirect(base_url()."admin/datamaster/matpel?msg=1");
    }
//End CRUD Mata Pelajaran



//CRUD KELAS
   function kelas(){
         $variabel['data'] = $this->m_kelas->lihatdata();
        $this->layout->render('back-end/datamaster/kelas/v_kelas',$variabel,'back-end/datamaster/kelas/v_kelas_js');
   }

    function kelaslihat()
    {
        $kd_kelas = $this->input->get("kd_kelas");
        $exec = $this->m_kelas->lihatdatasatu($kd_kelas);
        if ($exec->num_rows()>0){
            $variabel['data'] = $exec ->row_array();
            $this->layout->render('back-end/datamaster/kelas/v_kelas_lihat',$variabel,'back-end/datamaster/kelas/v_kelas_js');
        } else
            redirect(base_url("admin/datamaster/kelas"));
    }
    function kelastambah()
    {
        if ($this->input->post()){
                $array=array(
                    'kd_kelas'=> NULL,
                    'nama_kelas'=> $this->input->post('nama_kelas'),
                    'tingkat_kelas'=> $this->input->post('tingkat_kelas'),
                    'kapasitas'=>$this->input->post('kapasitas')
                    );

                $exec = $this->m_kelas->tambahdata($array);
                if ($exec) redirect(base_url("admin/datamaster/kelastambah?msg=1"));
                else redirect(base_url("admin/datamaster/kelastambah?msg=0"));
        } else {
            $variabel ='';
            $this->layout->render('back-end/datamaster/kelas/v_kelas_tambah',$variabel,'back-end/datamaster/kelas/v_kelas_js');
        }
    }

    function kelasedit()
    {
        if ($this->input->post()) {
            $kode = $this->input->post('kd_kelas');
            $array=array(
                'nama_kelas'=> $this->input->post('nama_kelas'),
                'tingkat_kelas'=> $this->input->post('tingkat_kelas'),
                'kapasitas'=> $this->input->post('kapasitas')
                );

                $exec = $this->m_kelas->editdata($kode,$array);
                if ($exec)
                  redirect(base_url("admin/datamaster/kelasedit?kd_kelas=".$kode."&msg=1"));
                else
                     redirect(base_url("admin/datamaster/kelasedit?kd_kelas=".$kode."&msg=0"));
        }
        else{
            $kode = $this->input->get("kd_kelas");
            $exec = $this->m_kelas->lihatdatasatu($kode);
            if ($exec->num_rows()>0){
                    $variabel['data'] = $exec ->row_array();
                    $this->layout->render('back-end/datamaster/kelas/v_kelas_edit',$variabel,'back-end/datamaster/kelas/v_kelas_js');
            }
            else
                redirect(base_url("admin/datamaster/kelas"));
        }
    }

    function kelashapus()
    {
       $kode = $this->input->get("kd_kelas");
       $exec = $this->m_kelas->hapus($kode);
       redirect(base_url()."admin/datamaster/kelas?msg=1");
    }
//end CRUD kelas

    // CRUD Guru
    function guru()
    {
        $variabel['data'] = $this->m_guru->lihatdata();
        $this->layout->render('back-end/datamaster/guru/v_guru',$variabel,'back-end/datamaster/guru/v_guru_js');
    }

    function gurulihat()
    {
        $nip = $this->input->get("nip");
        $exec = $this->m_guru->lihatdatasatu($nip);
        if ($exec->num_rows()>0){
            $variabel['data'] = $exec ->row_array();
            $this->layout->render('back-end/datamaster/guru/v_guru_lihat',$variabel,'back-end/datamaster/guru/v_guru_js');
        } else {
            redirect(base_url("admin/datamaster/guru"));
        }

    }

    function gurutambah()
    {
        if ($this->input->post()){

                $array=array(
                    'nip_guru'=> $this->input->post('nip_guru'),
                    'nik'=> $this->input->post('nik'),
                    'email_guru'=> $this->input->post('email_guru'),
                    'hp_guru'=> $this->input->post('hp_guru'),
                    'nama_lengkap'=>$this->input->post('nama_lengkap'),
                    'tempat_lahir'=>$this->input->post('tempat_lahir'),
                    'tgl_lahir'=>tanggalawal($this->input->post('tgl_lahir')),
                    'jenis_kelamin'=>$this->input->post('jenis_kelamin'),
                    'alamat_lengkap'=>$this->input->post('alamat_lengkap'),
                    'provinsi'=>$this->input->post('provinsi'),
                    'kabupaten_kota'=>$this->input->post('kabupaten_kota'),
                    'kecamatan'=>$this->input->post('kecamatan'),
                    'desa_kelurahan'=>$this->input->post('desa_kelurahan'),
                    'kode_pos'=>$this->input->post('kode_pos'),
                    'pendidikan_terakhir'=>$this->input->post('pendidikan_terakhir'),
                    'perguruan_tinggi'=>$this->input->post('perguruan_tinggi'),
                    'bidang_ilmu'=>$this->input->post('bidang_ilmu'),
                    'tahun_masuk'=>$this->input->post('tahun_masuk'),
                    'tahun_lulus'=>$this->input->post('tahun_lulus')



                    );
            if ($this->m_guru->cekdata($this->input->post('nip_guru'))==0) {
                $config['upload_path'] = './assets/images/foto';
                $config['allowed_types'] = 'jpg|jpeg|JPG|JPEG|PNG|png';
                $this->load->library('upload', $config);
                $this->upload->do_upload("foto");
                $upload = $this->upload->data();
                $foto = $upload["raw_name"].$upload["file_ext"];
                $array['foto']=$foto;
                $exec = $this->m_guru->tambahdata($array);
                if ($exec) redirect(base_url("admin/datamaster/gurutambah?msg=1"));
                else redirect(base_url("admin/datamaster/gurutambah?msg=0"));
            } else {



                $variabel['provinsi']=$this->m_santri->ambilprovinsi();
                $variabel['kabupaten']=$this->m_santri->ambilkabupaten($this->input->post('provinsi'));
                $variabel['kecamatan']=$this->m_santri->ambilkecamatan($this->input->post('kabupaten_kota'));
                $variabel['desa']=$this->m_santri->ambildesa($this->input->post('kecamatan'));
                $variabel['pendidikan']=$this->m_santri->ambilpendidikan();

                $variabel['nip_guru'] =$this->input->post('nip_guru');
                $this->layout->render('back-end/datamaster/guru/v_guru_tambah',$variabel,'back-end/datamaster/guru/v_guru_js');
            }

        } else {
             $variabel['provinsi']=$this->m_santri->ambilprovinsi();
             $variabel['pendidikan']
             =$this->m_santri->ambilpendidikan();
             $variabel['kabupaten']=$this->m_santri->ambilkabupaten("");
             $variabel['kecamatan']=$this->m_santri->ambilkecamatan("");
             $variabel['desa']=$this->m_santri->ambildesa("");
            $this->layout->render('back-end/datamaster/guru/v_guru_tambah',$variabel,'back-end/datamaster/guru/v_guru_js');
        }
    }

    function guruedit()
    {
        if ($this->input->post()) {
            $array=array(
                'nip_guru'=> $this->input->post('nip_guru'),
                'nik'=> $this->input->post('nik'),
                'email_guru'=> $this->input->post('email_guru'),
                'hp_guru'=> $this->input->post('hp_guru'),
                'nama_lengkap'=>$this->input->post('nama_lengkap'),
                'tempat_lahir'=>$this->input->post('tempat_lahir'),
                'tgl_lahir'=>tanggalawal($this->input->post('tgl_lahir')),
                'jenis_kelamin'=>$this->input->post('jenis_kelamin'),
                'alamat_lengkap'=>$this->input->post('alamat_lengkap'),
                'provinsi'=>$this->input->post('provinsi'),
                'kabupaten_kota'=>$this->input->post('kabupaten_kota'),
                'kecamatan'=>$this->input->post('kecamatan'),
                'desa_kelurahan'=>$this->input->post('desa_kelurahan'),
                'kode_pos'=>$this->input->post('kode_pos'),
                'pendidikan_terakhir'=>$this->input->post('pendidikan_terakhir'),
                'perguruan_tinggi'=>$this->input->post('perguruan_tinggi'),
                'bidang_ilmu'=>$this->input->post('bidang_ilmu'),
                'tahun_masuk'=>$this->input->post('tahun_masuk'),
                'tahun_lulus'=>$this->input->post('tahun_lulus')
                );
            $nip2 = $this->input->post("nip_guru2");
            $nip = $this->input->post("nip_guru");
            if (($this->m_guru->cekdata($nip)>0) && ($nip2!=$nip)) {
                $variabel['nip_guru'] =$this->input->post('nip_guru');
                $variabel['nip_guru2'] =$this->input->post('nip_guru2');
                $variabel['data'] = $array;

                $variabel['provinsi']=$this->m_santri->ambilprovinsi();
                $variabel['kabupaten']=$this->m_santri->ambilkabupaten($this->input->post('provinsi'));
                $variabel['kecamatan']=$this->m_santri->ambilkecamatan($this->input->post('kabupaten_kota'));
                $variabel['desa']=$this->m_santri->ambildesa($this->input->post('kecamatan'));
                $variabel['pendidikan']=$this->m_santri->ambilpendidikan();

                $this->layout->render('back-end/datamaster/guru/v_guru_edit',$variabel,'back-end/datamaster/guru/v_guru_js');
            } else {
                $config['upload_path'] = './assets/images/foto';
                $config['allowed_types'] = 'jpg|jpeg|JPG|JPEG|pdf|PNG|png';
                $this->load->library('upload', $config);
                if ($this->upload->do_upload("foto"))
                {
                    $upload = $this->upload->data();
                    $foto = $upload["raw_name"].$upload["file_ext"];
                    $array['foto']=$foto;

                    $query2 = $this->m_guru->lihatdatasatu($nip2);
                    $row2 = $query2->row();
                    $berkas1temp = $row2->foto;
                    $path1 ='./assets/images/foto/'.$berkas1temp.'';
                    echo "$path1";
                    if(is_file($path1)) {
                        unlink($path1); //menghapus gambar di folder produk
                    }
                }
                $exec = $this->m_guru->editdata($nip2,$array);
                if ($exec){
                  redirect(base_url("admin/datamaster/guruedit?nip=".$nip."&msg=1"));
                }
            }
      } else {
            $nip = $this->input->get("nip");
            $exec = $this->m_guru->lihatdatasatu($nip);
            if ($exec->num_rows()>0){
                 $variabel['data'] = $exec ->row_array();
                 $data = $variabel['data'];
                 $variabel['provinsi']=$this->m_santri->ambilprovinsi();
                 $variabel['pendidikan']=$this->m_santri->ambilpendidikan();
                 $variabel['kabupaten']=$this->m_santri->ambilkabupaten($data['provinsi']);
                 $variabel['kecamatan']=$this->m_santri->ambilkecamatan($data['kabupaten_kota']);
                 $variabel['desa']=$this->m_santri->ambildesa($data['kecamatan']);
                $this->layout->render('back-end/datamaster/guru/v_guru_edit',$variabel,'back-end/datamaster/guru/v_guru_js');
            } else {
                redirect(base_url("admin/datamaster/guru"));
            }
      }

    }

    function guruhapus()
    {
       $nip = $this->input->get("nip");
       $exec = $this->m_guru->hapus($nip);
       redirect(base_url()."admin/datamaster/guru?msg=1");
    }

    function guruberkas()
    {
        $nip = $this->input->get("nip");
        $exec = $this->m_guru->lihatdatasatu($nip);
        if ($exec->num_rows()>0){
            $variabel['guru'] = $exec->row_array();
            $variabel['data'] = $this->m_guru->lihatdataberkas($nip);
            $this->layout->render('back-end/datamaster/guru/v_guruberkas',$variabel,'back-end/datamaster/guru/v_guruberkas_js');
        } else {
            redirect(base_url("admin/datamaster/guru"));
        }

    }

    function gurutambahberkas()
    {
        $nip = $this->input->get("nip");
        $exec = $this->m_guru->lihatdatasatu($nip);
        if ($exec->num_rows()>0){
            $variabel['guru'] = $exec->row_array();
            if ($this->input->post()){
                $config['upload_path'] = './assets/berkas/berkasguru';
                $config['allowed_types'] = 'jpg|jpeg|JPG|JPEG|pdf';
                $this->load->library('upload', $config);
                $this->upload->do_upload("file_berkas");
                $upload = $this->upload->data();
                $file_berkas = $upload["raw_name"].$upload["file_ext"];

                $nip_guru = $this->input->post('nip_guru');
                $nama_berkas = $this->input->post('nama_berkas');
                $array=array(
                    'nip_guru'=>  $nip_guru,
                    'nama_berkas'=> $nama_berkas,
                    'file_berkas' => $file_berkas
                    );

                $exec = $this->m_guru->tambahdataberkas($array);
                if ($exec) redirect(base_url("admin/datamaster/gurutambahberkas?nip=".$nip_guru."&msg=1"));
                else redirect(base_url("admin/datamaster/guruberkastambah?nip=".$nip_guru."&msg=0"));
            } else {

                $this->layout->render('back-end/datamaster/guru/v_guruberkas_tambah',$variabel,'back-end/datamaster/guru/v_guruberkas_js');
            }
        } else {
            redirect(base_url("admin/datamaster/guru"));
        }
    }

    function guruhapusberkas()
    {
        $id_berkas = $this->input->get("id_berkas");
        $nip = $this->input->get("nip");

        $query2 = $this->m_guru->lihatdatasatuberkas($id_berkas);
        $row2 = $query2->row();
        $berkas1temp = $row2->file_berkas;
        $path1 ="./assets/berkas/berkasguru/".$berkas1temp."";
        if(is_file($path1)) {
            unlink($path1);
        }

        $exec = $this->m_guru->hapusberkas($id_berkas);
        redirect(base_url()."admin/datamaster/guruberkas?msg=1&nip=".$nip."");
    }

    function gurueditberkas()
    {
        if ($this->input->post()) {
            $id_berkas = $this->input->post('id_berkas');
            $nama_berkas = $this->input->post('nama_berkas');
            $nip_guru = $this->input->post('nip_guru');
            $array=array(
                'nama_berkas'=> $nama_berkas
                );

            $config['upload_path'] = './assets/berkas/berkasguru';
            $config['allowed_types'] = 'jpg|jpeg|JPG|JPEG|pdf';
            $this->load->library('upload', $config);
            if ( $this->upload->do_upload("file_berkas"))
            {
                $upload = $this->upload->data();
                $file_berkas = $upload["raw_name"].$upload["file_ext"];
                $array['file_berkas']=$file_berkas;

                $query2 = $this->m_guru->lihatdatasatuberkas($id_berkas);
                $row2 = $query2->row();
                $berkas1temp = $row2->file_berkas;
                $path1 ="./assets/berkas/berkasguru/".$berkas1temp."";
                if(is_file($path1)) {
                    unlink($path1); //menghapus gambar di folder produk
                }
            }
            $exec = $this->m_guru->editdataaberkas($id_berkas,$array);
            if ($exec) redirect(base_url("admin/datamaster/gurueditberkas?id=".$id_berkas."&nip=".$nip_guru."&msg=1"));
            else redirect(base_url("admin/datamaster/gurueditberkas?id=".$id_berkas."&nip=".$nip_guru."&msg=0"));

        } else {
            $nip = $this->input->get("nip");
            $id = $this->input->get("id");
            $exec = $this->m_guru->lihatdatasatu($nip);
            if ($exec->num_rows()>0){
                $variabel['guru'] = $exec ->row_array();
                $exec2 = $this->m_guru->lihatdatasatuberkas($id);
                if ($exec2->num_rows()>0){

                    $variabel['data'] = $exec2->row_array();
                    $this->layout->render('back-end/datamaster/guru/v_guruberkas_edit',$variabel,'back-end/datamaster/guru/v_guruberkas_js');
                } else {
                    redirect(base_url("admin/datamaster/guruberkas?nip=$nip"));
                }
            } else {
                redirect(base_url("admin/datamaster/guru"));
            }
        }

    }



    // End CRUD Guru

    // CRUD Staff
    function staff()
    {
        $variabel['data'] = $this->m_staff->lihatdata();
        $this->layout->render('back-end/datamaster/staff/v_staff',$variabel,'back-end/datamaster/staff/v_staff_js');
    }

    function stafflihat()
    {
        $nip = $this->input->get("nip");
        $exec = $this->m_staff->lihatdatasatu($nip);
        if ($exec->num_rows()>0){
            $variabel['data'] = $exec ->row_array();
            $this->layout->render('back-end/datamaster/staff/v_staff_lihat',$variabel,'back-end/datamaster/staff/v_staff_js');
        } else {
            redirect(base_url("admin/datamaster/staff"));
        }

    }

    function stafftambah()
    {
        if ($this->input->post()){

                $array=array(
                    'nip_staff'=> $this->input->post('nip_staff'),
                    'nik'=> $this->input->post('nik'),
                    'email_staff'=> $this->input->post('email_staff'),
                    'hp_staff'=> $this->input->post('hp_staff'),
                    'nama_lengkap'=>$this->input->post('nama_lengkap'),
                    'tempat_lahir'=>$this->input->post('tempat_lahir'),
                    'tgl_lahir'=>tanggalawal($this->input->post('tgl_lahir')),
                    'jenis_kelamin'=>$this->input->post('jenis_kelamin'),
                    'alamat_lengkap'=>$this->input->post('alamat_lengkap'),
                    'provinsi'=>$this->input->post('provinsi'),
                    'kabupaten_kota'=>$this->input->post('kabupaten_kota'),
                    'kecamatan'=>$this->input->post('kecamatan'),
                    'desa_kelurahan'=>$this->input->post('desa_kelurahan'),
                    'kode_pos'=>$this->input->post('kode_pos'),
                    'pendidikan_terakhir'=>$this->input->post('pendidikan_terakhir')
                    );
            if ($this->m_staff->cekdata($this->input->post('nip_staff'))==0) {
                $exec = $this->m_staff->tambahdata($array);
                if ($exec) redirect(base_url("admin/datamaster/stafftambah?msg=1"));
                else redirect(base_url("admin/datamaster/stafftambah?msg=0"));
            } else {
                $variabel['nip_staff'] =$this->input->post('nip_staff');
                $variabel['provinsi']=$this->m_santri->ambilprovinsi();
                $variabel['kabupaten']=$this->m_santri->ambilkabupaten($this->input->post('provinsi'));
                $variabel['kecamatan']=$this->m_santri->ambilkecamatan($this->input->post('kabupaten_kota'));
                $variabel['desa']=$this->m_santri->ambildesa($this->input->post('kecamatan'));
                $variabel['pendidikan']=$this->m_santri->ambilpendidikan();

                $variabel['nip_guru'] =$this->input->post('nip_guru');
                $this->layout->render('back-end/datamaster/staff/v_staff_tambah',$variabel,'back-end/datamaster/staff/v_staff_js');
            }

        } else {
            $variabel['provinsi']=$this->m_santri->ambilprovinsi();
            $variabel['pendidikan'] =$this->m_santri->ambilpendidikan();
            $variabel['kabupaten']=$this->m_santri->ambilkabupaten("");
            $variabel['kecamatan']=$this->m_santri->ambilkecamatan("");
            $variabel['desa']=$this->m_santri->ambildesa("");
            $this->layout->render('back-end/datamaster/staff/v_staff_tambah',$variabel,'back-end/datamaster/staff/v_staff_js');
        }
    }

    function staffedit()
    {
        if ($this->input->post()) {
            $array=array(
                'nip_staff'=> $this->input->post('nip_staff'),
                'nik'=> $this->input->post('nik'),
                'email_staff'=> $this->input->post('email_staff'),
                'hp_staff'=> $this->input->post('hp_staff'),
                'nama_lengkap'=>$this->input->post('nama_lengkap'),
                'tempat_lahir'=>$this->input->post('tempat_lahir'),
                'tgl_lahir'=>tanggalawal($this->input->post('tgl_lahir')),
                'jenis_kelamin'=>$this->input->post('jenis_kelamin'),
                'alamat_lengkap'=>$this->input->post('alamat_lengkap'),
                'provinsi'=>$this->input->post('provinsi'),
                'kabupaten_kota'=>$this->input->post('kabupaten_kota'),
                'kecamatan'=>$this->input->post('kecamatan'),
                'desa_kelurahan'=>$this->input->post('desa_kelurahan'),
                'kode_pos'=>$this->input->post('kode_pos'),
                'pendidikan_terakhir'=>$this->input->post('pendidikan_terakhir')
                );
            $nip2 = $this->input->post("nip_staff2");
            $nip = $this->input->post("nip_staff");
            if (($this->m_staff->cekdata($nip)>0) && ($nip2!=$nip)) {
                $variabel['nip_staff'] =$this->input->post('nip_staff');
                $variabel['nip_staff2'] =$this->input->post('nip_staff2');
                $variabel['data'] = $array;
                $variabel['provinsi']=$this->m_santri->ambilprovinsi();
                $variabel['kabupaten']=$this->m_santri->ambilkabupaten($this->input->post('provinsi'));
                $variabel['kecamatan']=$this->m_santri->ambilkecamatan($this->input->post('kabupaten_kota'));
                $variabel['desa']=$this->m_santri->ambildesa($this->input->post('kecamatan'));
                $variabel['pendidikan']=$this->m_santri->ambilpendidikan();
                $this->layout->render('back-end/datamaster/staff/v_staff_edit',$variabel,'back-end/datamaster/staff/v_staff_js');
            } else {
                $exec = $this->m_staff->editdata($nip2,$array);
                if ($exec){
                  redirect(base_url("admin/datamaster/staffedit?nip=".$nip."&msg=1"));
                }
            }
      } else {
            $nip = $this->input->get("nip");
            $exec = $this->m_staff->lihatdatasatu($nip);
            if ($exec->num_rows()>0){
                $variabel['data'] = $exec ->row_array();
                $data = $variabel['data'] ;
                $variabel['provinsi']=$this->m_santri->ambilprovinsi();
                $variabel['pendidikan']=$this->m_santri->ambilpendidikan();
                $variabel['kabupaten']=$this->m_santri->ambilkabupaten($data['provinsi']);
                $variabel['kecamatan']=$this->m_santri->ambilkecamatan($data['kabupaten_kota']);
                $variabel['desa']=$this->m_santri->ambildesa($data['kecamatan']);
                $this->layout->render('back-end/datamaster/staff/v_staff_edit',$variabel,'back-end/datamaster/staff/v_staff_js');
            } else {
                redirect(base_url("admin/datamaster/staff"));
            }
      }

    }

    function staffhapus()
    {
       $nip = $this->input->get("nip");
       $exec = $this->m_staff->hapus($nip);
       redirect(base_url()."admin/datamaster/staff?msg=1");
    }

    function staffberkas()
    {
        $nip = $this->input->get("nip");
        $exec = $this->m_staff->lihatdatasatu($nip);
        if ($exec->num_rows()>0){
            $variabel['staff'] = $exec->row_array();
            $variabel['data'] = $this->m_staff->lihatdataberkas($nip);
            $this->layout->render('back-end/datamaster/staff/v_staffberkas',$variabel,'back-end/datamaster/staff/v_staffberkas_js');
        } else {
            redirect(base_url("admin/datamaster/staff"));
        }

    }

    function stafftambahberkas()
    {
        $nip = $this->input->get("nip");
        $exec = $this->m_staff->lihatdatasatu($nip);
        if ($exec->num_rows()>0){
            $variabel['staff'] = $exec->row_array();
            if ($this->input->post()){
                $config['upload_path'] = './assets/berkas/berkasstaff';
                $config['allowed_types'] = 'jpg|jpeg|JPG|JPEG|pdf';
                $this->load->library('upload', $config);
                $this->upload->do_upload("file_berkas");
                $upload = $this->upload->data();
                $file_berkas = $upload["raw_name"].$upload["file_ext"];

                $nip_staff = $this->input->post('nip_staff');
                $nama_berkas = $this->input->post('nama_berkas');
                $array=array(
                    'nip_staff'=>  $nip_staff,
                    'nama_berkas'=> $nama_berkas,
                    'file_berkas' => $file_berkas
                    );

                $exec = $this->m_staff->tambahdataberkas($array);
                if ($exec) redirect(base_url("admin/datamaster/stafftambahberkas?nip=".$nip_staff."&msg=1"));
                else redirect(base_url("admin/datamaster/staffberkastambah?nip=".$nip_staff."&msg=0"));
            } else {

                $this->layout->render('back-end/datamaster/staff/v_staffberkas_tambah',$variabel,'back-end/datamaster/staff/v_staffberkas_js');
            }
        } else {
            redirect(base_url("admin/datamaster/staff"));
        }
    }

    function staffhapusberkas()
    {
        $id_berkas = $this->input->get("id_berkas");
        $nip = $this->input->get("nip");

        $query2 = $this->m_staff->lihatdatasatuberkas($id_berkas);
        $row2 = $query2->row();
        $berkas1temp = $row2->file_berkas;
        $path1 ="./assets/berkas/berkasstaff/".$berkas1temp."";
        if(is_file($path1)) {
            unlink($path1);
        }

        $exec = $this->m_staff->hapusberkas($id_berkas);
        redirect(base_url()."admin/datamaster/staffberkas?msg=1&nip=".$nip."");
    }

    function staffeditberkas()
    {
        if ($this->input->post()) {
            $id_berkas = $this->input->post('id_berkas');
            $nama_berkas = $this->input->post('nama_berkas');
            $nip_staff = $this->input->post('nip_staff');
            $array=array(
                'nama_berkas'=> $nama_berkas
                );

            $config['upload_path'] = './assets/berkas/berkasstaff';
            $config['allowed_types'] = 'jpg|jpeg|JPG|JPEG|pdf';
            $this->load->library('upload', $config);
            if ( $this->upload->do_upload("file_berkas"))
            {
                $upload = $this->upload->data();
                $file_berkas = $upload["raw_name"].$upload["file_ext"];
                $array['file_berkas']=$file_berkas;

                $query2 = $this->m_staff->lihatdatasatuberkas($id_berkas);
                $row2 = $query2->row();
                $berkas1temp = $row2->file_berkas;
                $path1 ="./assets/berkas/berkasstaff/".$berkas1temp."";
                if(is_file($path1)) {
                    unlink($path1); //menghapus gambar di folder produk
                }
            }
            $exec = $this->m_staff->editdataaberkas($id_berkas,$array);
            if ($exec) redirect(base_url("admin/datamaster/staffeditberkas?id=".$id_berkas."&nip=".$nip_staff."&msg=1"));
            else redirect(base_url("admin/datamaster/staffeditberkas?id=".$id_berkas."&nip=".$nip_staff."&msg=0"));

        } else {
            $nip = $this->input->get("nip");
            $id = $this->input->get("id");
            $exec = $this->m_staff->lihatdatasatu($nip);
            if ($exec->num_rows()>0){
                $variabel['staff'] = $exec ->row_array();
                $exec2 = $this->m_staff->lihatdatasatuberkas($id);
                if ($exec2->num_rows()>0){

                    $variabel['data'] = $exec2->row_array();
                    $this->layout->render('back-end/datamaster/staff/v_staffberkas_edit',$variabel,'back-end/datamaster/staff/v_staffberkas_js');
                } else {
                    redirect(base_url("admin/datamaster/staffberkas?nip=$nip"));
                }
            } else {
                redirect(base_url("admin/datamaster/staff"));
            }
        }

    }

    // End CRUD Staff

    // CRUD tahun ajaran
    function tahunajar()
    {
        $variabel['data'] = $this->m_tahun_ajaran->lihatdata();
        $this->layout->render('back-end/datamaster/tahunajar/v_tahunajar',$variabel,'back-end/datamaster/tahunajar/v_tahunajar_js');
    }



    function tahunajartambah()
    {
        if ($this->input->post()){

                $array=array(

                    'tahun_ajaran'=> $this->input->post('tahun_ajaran'),
                    );
                $exec = $this->m_tahun_ajaran->tambahdata($array);
                if ($exec) redirect(base_url("admin/datamaster/tahunajartambah?msg=1"));
                else redirect(base_url("admin/datamaster/tahunajartambah?msg=0"));
            }

         else {
            $variabel ='';
            $this->layout->render('back-end/datamaster/tahunajar/v_tahunajar_tambah',$variabel,'back-end/datamaster/tahunajar/v_tahunajar_js');
        }
    }

    function tahunajaredit()
    {
        if ($this->input->post()) {
            $array=array(
              'id_tahun'=>$this->input->post('id_tahun'),
              'tahun_ajaran'=> $this->input->post('tahun_ajaran'),
                );
            $id_tahunlama = $this->input->post("id_tahunlama");
            $id_tahun = $this->input->post("id_tahun");
            if (($this->m_tahun_ajaran->cekdata($id_tahun)>0) && ($id_tahunlama!=$id_tahun)) {
                $variabel['id_tahun'] =$this->input->post('id_tahun');
                $variabel['id_tahunlama'] =$this->input->post('id_tahunlama');
                $variabel['data'] = $array;
                $this->layout->render('back-end/datamaster/tahunajar/v_tahunajar_edit',$variabel,'back-end/datamaster/tahunajar/v_tahunajar_js');
            } else {
                $exec = $this->m_tahun_ajaran->editdata($id_tahunlama,$array);
                if ($exec){
                  redirect(base_url("admin/datamaster/tahunajaredit?id_tahun=".$id_tahun."&msg=1"));
                }
            }
      } else {
            $id_tahun = $this->input->get("id_tahun");
            $exec = $this->m_tahun_ajaran->lihatdatasatu($id_tahun);
            if ($exec->num_rows()>0){
                $variabel['data'] = $exec ->row_array();
                $this->layout->render('back-end/datamaster/tahunajar/v_tahunajar_edit',$variabel,'back-end/datamaster/tahunajar/v_tahunajar_js');
            } else {
                redirect(base_url("admin/datamaster/tahunajar"));
            }
      }

    }

    function tahunajarhapus()
    {
       $id_tahun = $this->input->get("id_tahun");
       $exec = $this->m_tahun_ajaran->hapus($id_tahun);
       redirect(base_url()."admin/datamaster/tahunajar?msg=1");
    }

    // End CRUD tahunajar



   // CRUD provinsi
   function provinsi()
   {
       $variabel['data'] = $this->m_provinsi->lihatdata();
       $this->layout->render('back-end/datamaster/provinsi/v_provinsi',$variabel,'back-end/datamaster/provinsi/v_provinsi_js');
   }



   function provinsitambah()
   {
       if ($this->input->post()){

               $array=array(
                   'id_provinsi'=> $this->input->post('id_provinsi'),
                   'nama_provinsi'=> $this->input->post('nama_provinsi'),
                   );
           if ($this->m_provinsi->cekdata($this->input->post('id_provinsi'))==0) {
               $exec = $this->m_provinsi->tambahdata($array);
               if ($exec) redirect(base_url("admin/datamaster/provinsitambah?msg=1"));
               else redirect(base_url("admin/datamaster/provinsitambah?msg=0"));
           } else {
               $variabel['id_provinsi'] =$this->input->post('id_provinsi');
               $this->layout->render('back-end/datamaster/provinsi/v_provinsi_tambah',$variabel,'back-end/datamaster/provinsi/v_provinsi_js');
           }

       } else {
           $variabel ='';
           $this->layout->render('back-end/datamaster/provinsi/v_provinsi_tambah',$variabel,'back-end/datamaster/provinsi/v_provinsi_js');
       }
   }

   function provinsiedit()
   {
       if ($this->input->post()) {
           $array=array(
             'id_provinsi'=> $this->input->post('id_provinsi'),
             'nama_provinsi'=> $this->input->post('nama_provinsi'),
               );
           $id_provinsilama = $this->input->post("id_provinsilama");
           $id_provinsi = $this->input->post("id_provinsi");
           if (($this->m_provinsi->cekdata($id_provinsi)>0) && ($id_provinsilama!=$id_provinsi)) {
               $variabel['id_provinsi'] =$this->input->post('id_provinsi');
               $variabel['id_provinsilama'] =$this->input->post('id_provinsilama');
               $variabel['data'] = $array;
               $this->layout->render('back-end/datamaster/provinsi/v_provinsi_edit',$variabel,'back-end/datamaster/provinsi/v_provinsi_js');
           } else {
               $exec = $this->m_provinsi->editdata($id_provinsilama,$array);
               if ($exec){
                 redirect(base_url("admin/datamaster/provinsiedit?id_provinsi=".$id_provinsi."&msg=1"));
               }
           }
     } else {
           $id_provinsi = $this->input->get("id_provinsi");
           $exec = $this->m_provinsi->lihatdatasatu($id_provinsi);
           if ($exec->num_rows()>0){
               $variabel['data'] = $exec ->row_array();
               $this->layout->render('back-end/datamaster/provinsi/v_provinsi_edit',$variabel,'back-end/datamaster/provinsi/v_provinsi_js');
           } else {
               redirect(base_url("admin/datamaster/provinsi"));
           }
     }

   }

   function provinsihapus()
   {
      $id_provinsi = $this->input->get("id_provinsi");
      $exec = $this->m_provinsi->hapus($id_provinsi);
      redirect(base_url()."admin/datamaster/provinsi?msg=1");
   }

   // End CRUD Provinsi


// END Provinsi
// CRUD Kota dan Kabupaten


function kota_kab()
{
    $variabel['data'] = $this->m_kota_kab->lihatdata();
    $this->layout->render('back-end/datamaster/kota_kab/v_kota_kab',$variabel,'back-end/datamaster/kota_kab/v_kota_kab_js');
}



function kota_kabtambah()
{
    if ($this->input->post()){

            $array=array(
                'id_provinsi'=> $this->input->post('id_provinsi'),
                'nama_kota_kab'=> $this->input->post('nama_kota_kab'),
                );
            $exec = $this->m_kota_kab->tambahdata($array);
            if ($exec) redirect(base_url("admin/datamaster/kota_kabtambah?msg=1"));
            else redirect(base_url("admin/datamaster/kota_kabtambah?msg=0"));

    } else {

        $variabel['data'] =   $this->m_kota_kab->dataprovinsi();
        $this->layout->render('back-end/datamaster/kota_kab/v_kota_kab_tambah',$variabel,'back-end/datamaster/kota_kab/v_kota_kab_js');
    }
}

function kota_kabedit()
{
    if ($this->input->post()) {
        $array=array(
          'id_kota_kab'=> $this->input->post('id_kota_kab'),
          'nama_kota_kab'=> $this->input->post('nama_kota_kab'),
          'id_provinsi'=> $this->input->post('id_provinsi'),
            );
            $id_kota_kab = $this->input->post("id_kota_kab");
            $exec = $this->m_kota_kab->editdata($id_kota_kab,$array);
            if ($exec){
              redirect(base_url("admin/datamaster/kota_kabedit?id_kota_kab=".$id_kota_kab."&msg=1"));
            }

  } else {
        $id_kota_kab = $this->input->get("id_kota_kab");
        $exec = $this->m_kota_kab->lihatdatasatu($id_kota_kab);
        if ($exec->num_rows()>0){
            $variabel['data'] = $exec ->row_array();
            $variabel['dataprovinsi'] = $this->m_kota_kab->dataprovinsi();
            $this->layout->render('back-end/datamaster/kota_kab/v_kota_kab_edit',$variabel,'back-end/datamaster/kota_kab/v_kota_kab_js');
        } else {
            redirect(base_url("admin/datamaster/kota_kab"));
        }
  }

}

function kota_kabhapus()
{
   $id_kota_kab = $this->input->get("id_kota_kab");
   $exec = $this->m_kota_kab->hapus($id_kota_kab);
   redirect(base_url()."admin/datamaster/kota_kab?msg=1");
}
// End CRUD Kota dan Kabupaten

// CRUD kecamatan
function kecamatan()
{
    $variabel['data'] = $this->m_kecamatan->lihatdata();
    $this->layout->render('back-end/datamaster/kecamatan/v_kecamatan',$variabel,'back-end/datamaster/kecamatan/v_kecamatan_js');
}

function datakotakab()
{
  $id=$this->input->post('id');
  $data=$this->m_kecamatan->datakota_kab($id);
  echo json_encode($data);
}

function kecamatantambah()
{
    if ($this->input->post()){

            $array=array(

                'id_kota_kab'=> $this->input->post('id_kota_kab'),
                'nama_kecamatan'=> $this->input->post('nama_kecamatan'),
                );
            $exec = $this->m_kecamatan->tambahdata($array);
            if ($exec) redirect(base_url("admin/datamaster/kecamatantambah?msg=1"));
            else redirect(base_url("admin/datamaster/kecamatantambah?msg=0"));

    } else {
        $variabel['data'] =   $this->m_kecamatan->dataprovinsi();
        $this->layout->render('back-end/datamaster/kecamatan/v_kecamatan_tambah',$variabel,'back-end/datamaster/kecamatan/v_kecamatan_js');
    }
}

function kecamatanedit()
{
    if ($this->input->post()) {
        $array=array(
          'id_kota_kab'=> $this->input->post('id_kota_kab'),
          'nama_kecamatan'=> $this->input->post('nama_kecamatan'),
            );
            $id_kecamatan = $this->input->post("id_kecamatan");
            $id_provinsi = $this->input->post("id_provinsi");
            $exec = $this->m_kecamatan->editdata($id_kecamatan,$array);
            if ($exec){
              redirect(base_url("admin/datamaster/kecamatanedit?id_kecamatan=".$id_kecamatan."&id_provinsi=".$id_provinsi."&msg=1"));
            }

  } else {
      $id_kecamatan = $this->input->get("id_kecamatan");
      $id_provinsi = $this->input->get("id_provinsi");
        $exec = $this->m_kecamatan->lihatdatasatu($id_kecamatan);
        if ($exec->num_rows()>0){
            $variabel['data'] = $exec ->row_array();
            $variabel['dataprovinsi'] = $this->m_kecamatan->dataprovinsi();
            $variabel['datakotakab']  = $this->m_kecamatan->datakotakab($id_provinsi);
            $this->layout->render('back-end/datamaster/kecamatan/v_kecamatan_edit',$variabel,'back-end/datamaster/kecamatan/v_kecamatan_js');
        } else {
            redirect(base_url("admin/datamaster/kecamatan"));
        }
  }

}

function kecamatanhapus()
{
   $id_kecamatan = $this->input->get("id_kecamatan");
   $exec = $this->m_kecamatan->hapus($id_kecamatan);
   redirect(base_url()."admin/datamaster/kecamatan?msg=1");
}
  // End CRUD Kecamatan

  // CRUD kel_desa
  function kel_desa()
  {
      $variabel['data'] = $this->m_kel_desa->lihatdata();
      $this->layout->render('back-end/datamaster/kel_desa/v_kel_desa',$variabel,'back-end/datamaster/kel_desa/v_kel_desa_js');
  }

  function datakecamatan()
  {
    $id=$this->input->post('id');
    $data=$this->m_kel_desa->datakecamatanajax($id);
    echo json_encode($data);
  }

  function kel_desatambah()
  {
      if ($this->input->post()){

              $array=array(

                  'id_kecamatan'=> $this->input->post('id_kecamatan'),
                  'nama_kel_desa'=> $this->input->post('nama_kel_desa'),
                  );
              $exec = $this->m_kel_desa->tambahdata($array);
              if ($exec) redirect(base_url("admin/datamaster/kel_desatambah?msg=1"));
              else redirect(base_url("admin/datamaster/kel_desatambah?msg=0"));

      } else {
          $variabel['data'] =   $this->m_kel_desa->dataprovinsi();
          $this->layout->render('back-end/datamaster/kel_desa/v_kel_desa_tambah',$variabel,'back-end/datamaster/kel_desa/v_kel_desa_js');
      }
  }

  function kel_desaedit()
  {
      if ($this->input->post()) {
          $array=array(
            'id_kecamatan'=> $this->input->post('id_kecamatan'),
            'nama_kel_desa'=> $this->input->post('nama_kel_desa'),
              );
              $id_kel_desa = $this->input->post("id_kel_desa");
              $id_provinsi = $this->input->post("id_provinsi");
              $id_kota_kab = $this->input->post("id_kota_kab");
              $exec = $this->m_kel_desa->editdata($id_kel_desa,$array);
              if ($exec){
                redirect(base_url("admin/datamaster/kel_desaedit?id_kel_desa=".$id_kel_desa."&id_provinsi=".$id_provinsi."&id_kota_kab=".$id_kota_kab."&msg=1"));
              }

    } else {
        $id_kel_desa  = $this->input->get("id_kel_desa");
        $id_provinsi = $this->input->get("id_provinsi");
        $id_kota_kab = $this->input->get("id_kota_kab");
          $exec = $this->m_kel_desa->lihatdatasatu($id_kel_desa);
          if ($exec->num_rows()>0){
              $variabel['data'] = $exec ->row_array();
              $variabel['dataprovinsi'] = $this->m_kel_desa->dataprovinsi();
              $variabel['datakotakab']  = $this->m_kel_desa->datakotakab($id_provinsi);
              $variabel['datakecamatan'] = $this->m_kel_desa->datakecamatan($id_kota_kab);
              $this->layout->render('back-end/datamaster/kel_desa/v_kel_desa_edit',$variabel,'back-end/datamaster/kel_desa/v_kel_desa_js');
          } else {
              redirect(base_url("admin/datamaster/kel_desa"));
          }
    }

  }

  function kel_desahapus()
  {
     $id_kel_desa = $this->input->get("id_kel_desa");
     $exec = $this->m_kel_desa->hapus($id_kel_desa);
     redirect(base_url()."admin/datamaster/kel_desa?msg=1");
  }
    // End CRUD Kecamatan


   // CRUD Pendidikan
   function pendidikan()
   {
       $variabel['data'] = $this->m_pendidikan->lihatdata();
       $this->layout->render('back-end/datamaster/pendidikan/v_pendidikan',$variabel,'back-end/datamaster/pendidikan/v_pendidikan_js');
   }

   function pendidikantambah()
   {
       if ($this->input->post()){

               $array=array(
                   'id_pendidikan'=> $this->input->post('id_pendidikan'),
                   'nama_pendidikan'=> $this->input->post('nama_pendidikan'),
                   );
           if ($this->m_pendidikan->cekdata($this->input->post('id_pendidikan'))==0) {
               $exec = $this->m_pendidikan->tambahdata($array);
               if ($exec) redirect(base_url("admin/datamaster/pendidikantambah?msg=1"));
               else redirect(base_url("admin/datamaster/pendidikantambah?msg=0"));
           } else {
               $variabel['id_pendidikan'] =$this->input->post('id_pendidikan');
               $this->layout->render('back-end/datamaster/pendidikan/v_pendidikan_tambah',$variabel,'back-end/datamaster/pendidikan/v_pendidikan_js');
           }

       } else {
           $variabel ='';
           $this->layout->render('back-end/datamaster/pendidikan/v_pendidikan_tambah',$variabel,'back-end/datamaster/pendidikan/v_pendidikan_js');
       }
   }

   function pendidikanedit()
   {
       if ($this->input->post()) {
           $array=array(
             'id_pendidikan'=> $this->input->post('id_pendidikan'),
             'nama_pendidikan'=> $this->input->post('nama_pendidikan'),
               );
           $id_pendidikanlama = $this->input->post("id_pendidikanlama");
           $id_pendidikan = $this->input->post("id_pendidikan");
           if (($this->m_pendidikan->cekdata($id_pendidikan)>0) && ($id_pendidikanlama!=$id_pendidikan)) {
               $variabel['id_pendidikan'] =$this->input->post('id_pendidikan');
               $variabel['id_pendidikanlama'] =$this->input->post('id_pendidikanlama');
               $variabel['data'] = $array;
               $this->layout->render('back-end/datamaster/pendidikan/v_pendidikan_edit',$variabel,'back-end/datamaster/pendidikan/v_pendidikan_js');
           } else {
               $exec = $this->m_pendidikan->editdata($id_pendidikanlama,$array);
               if ($exec){
                 redirect(base_url("admin/datamaster/pendidikanedit?id_pendidikan=".$id_pendidikan."&msg=1"));
               }
           }
     } else {
           $id_pendidikan = $this->input->get("id_pendidikan");
           $exec = $this->m_pendidikan->lihatdatasatu($id_pendidikan);
           if ($exec->num_rows()>0){
               $variabel['data'] = $exec ->row_array();
               $this->layout->render('back-end/datamaster/pendidikan/v_pendidikan_edit',$variabel,'back-end/datamaster/pendidikan/v_pendidikan_js');
           } else {
               redirect(base_url("admin/datamaster/pendidikan"));
           }
     }

   }

   function pendidikanhapus()
   {
      $id_pendidikan = $this->input->get("id_pendidikan");
      $exec = $this->m_pendidikan->hapus($id_pendidikan);
      redirect(base_url()."admin/datamaster/pendidikan?msg=1");
   }
   // End CRUD Pendidikan


   // CRUD Pekerjaan
   function pekerjaan()
   {
       $variabel['data'] = $this->m_pekerjaan->lihatdata();
       $this->layout->render('back-end/datamaster/pekerjaan/v_pekerjaan',$variabel,'back-end/datamaster/pekerjaan/v_pekerjaan_js');
   }

   function pekerjaantambah()
   {
       if ($this->input->post()){

               $array=array(
                   'id_pekerjaan'=> $this->input->post('id_pekerjaan'),
                   'nama_pekerjaan'=> $this->input->post('nama_pekerjaan'),
                   );
           if ($this->m_pekerjaan->cekdata($this->input->post('id_pekerjaan'))==0) {
               $exec = $this->m_pekerjaan->tambahdata($array);
               if ($exec) redirect(base_url("admin/datamaster/pekerjaantambah?msg=1"));
               else redirect(base_url("admin/datamaster/pekerjaantambah?msg=0"));
           } else {
               $variabel['id_pekerjaan'] =$this->input->post('id_pekerjaan');
               $this->layout->render('back-end/datamaster/pekerjaan/v_pekerjaan_tambah',$variabel,'back-end/datamaster/pekerjaan/v_pekerjaan_js');
           }

       } else {
           $variabel ='';
           $this->layout->render('back-end/datamaster/pekerjaan/v_pekerjaan_tambah',$variabel,'back-end/datamaster/pekerjaan/v_pekerjaan_js');
       }
   }

   function pekerjaanedit()
   {
       if ($this->input->post()) {
           $array=array(
             'id_pekerjaan'=> $this->input->post('id_pekerjaan'),
             'nama_pekerjaan'=> $this->input->post('nama_pekerjaan'),
               );
           $id_pekerjaanlama = $this->input->post("id_pekerjaanlama");
           $id_pekerjaan = $this->input->post("id_pekerjaan");
           if (($this->m_pekerjaan->cekdata($id_pekerjaan)>0) && ($id_pekerjaanlama!=$id_pekerjaan)) {
               $variabel['id_pekerjaan'] =$this->input->post('id_pekerjaan');
               $variabel['id_pekerjaanlama'] =$this->input->post('id_pekerjaanlama');
               $variabel['data'] = $array;
               $this->layout->render('back-end/datamaster/pekerjaan/v_pekerjaan_edit',$variabel,'back-end/datamaster/pekerjaan/v_pekerjaan_js');
           } else {
               $exec = $this->m_pekerjaan->editdata($id_pekerjaanlama,$array);
               if ($exec){
                 redirect(base_url("admin/datamaster/pekerjaanedit?id_pekerjaan=".$id_pekerjaan."&msg=1"));
               }
           }
     } else {
           $id_pekerjaan = $this->input->get("id_pekerjaan");
           $exec = $this->m_pekerjaan->lihatdatasatu($id_pekerjaan);
           if ($exec->num_rows()>0){
               $variabel['data'] = $exec ->row_array();
               $this->layout->render('back-end/datamaster/pekerjaan/v_pekerjaan_edit',$variabel,'back-end/datamaster/pekerjaan/v_pekerjaan_js');
           } else {
               redirect(base_url("admin/datamaster/pekerjaan"));
           }
     }

   }

   function pekerjaanhapus()
   {
      $id_pekerjaan = $this->input->get("id_pekerjaan");
      $exec = $this->m_pekerjaan->hapus($id_pekerjaan);
      redirect(base_url()."admin/datamaster/pekerjaan?msg=1");
   }
   // End CRUD Pekerjaan



   // CRUD Alat Transportasi
   function alat_transportasi()
   {
       $variabel['data'] = $this->m_alat_transportasi->lihatdata();
       $this->layout->render('back-end/datamaster/alat_transportasi/v_alat_transportasi',$variabel,'back-end/datamaster/alat_transportasi/v_alat_transportasi_js');
   }

   function alat_transportasitambah()
   {
       if ($this->input->post()){

               $array=array(
                   'id_alat_transportasi'=> $this->input->post('id_alat_transportasi'),
                   'nama_alat_transportasi'=> $this->input->post('nama_alat_transportasi'),
                   );
           if ($this->m_alat_transportasi->cekdata($this->input->post('id_alat_transportasi'))==0) {
               $exec = $this->m_alat_transportasi->tambahdata($array);
               if ($exec) redirect(base_url("admin/datamaster/alat_transportasitambah?msg=1"));
               else redirect(base_url("admin/datamaster/alat_transportasitambah?msg=0"));
           } else {
               $variabel['id_alat_transportasi'] =$this->input->post('id_alat_transportasi');
               $this->layout->render('back-end/datamaster/alat_transportasi/v_alat_transportasi_tambah',$variabel,'back-end/datamaster/alat_transportasi/v_alat_transportasi_js');
           }

       } else {
           $variabel ='';
           $this->layout->render('back-end/datamaster/alat_transportasi/v_alat_transportasi_tambah',$variabel,'back-end/datamaster/alat_transportasi/v_alat_transportasi_js');
       }
   }

   function alat_transportasiedit()
   {
       if ($this->input->post()) {
           $array=array(
             'id_alat_transportasi'=> $this->input->post('id_alat_transportasi'),
             'nama_alat_transportasi'=> $this->input->post('nama_alat_transportasi'),
               );
           $id_alat_transportasilama = $this->input->post("id_alat_transportasilama");
           $id_alat_transportasi = $this->input->post("id_alat_transportasi");
           if (($this->m_alat_transportasi->cekdata($id_alat_transportasi)>0) && ($id_alat_transportasilama!=$id_alat_transportasi)) {
               $variabel['id_alat_transportasi'] =$this->input->post('id_alat_transportasi');
               $variabel['id_alat_transportasilama'] =$this->input->post('id_alat_transportasilama');
               $variabel['data'] = $array;
               $this->layout->render('back-end/datamaster/alat_transportasi/v_alat_transportasi_edit',$variabel,'back-end/datamaster/alat_transportasi/v_alat_transportasi_js');
           } else {
               $exec = $this->m_alat_transportasi->editdata($id_alat_transportasilama,$array);
               if ($exec){
                 redirect(base_url("admin/datamaster/alat_transportasiedit?id_alat_transportasi=".$id_alat_transportasi."&msg=1"));
               }
           }
     } else {
           $id_alat_transportasi = $this->input->get("id_alat_transportasi");
           $exec = $this->m_alat_transportasi->lihatdatasatu($id_alat_transportasi);
           if ($exec->num_rows()>0){
               $variabel['data'] = $exec ->row_array();
               $this->layout->render('back-end/datamaster/alat_transportasi/v_alat_transportasi_edit',$variabel,'back-end/datamaster/alat_transportasi/v_alat_transportasi_js');
           } else {
               redirect(base_url("admin/datamaster/alat_transportasi"));
           }
     }

   }

   function alat_transportasihapus()
   {
      $id_alat_transportasi = $this->input->get("id_alat_transportasi");
      $exec = $this->m_alat_transportasi->hapus($id_alat_transportasi);
      redirect(base_url()."admin/datamaster/alat_transportasi?msg=1");
   }
   // End CRUD Alat Transportasi

///////////////////////////////////////////memulai presensi////////////////////////////////////////////////
   function datakelasbelajar()
   {
      $variabel['data']=$this->m_presensi->lihatdata();
      $this->layout->render('back-end/presensi/presensi_kelas/v_presensi_kelas',$variabel,'back-end/presensi/presensi_kelas/v_preskelas_js');
   }

   function aturkelasbelajar(){
        if ($this->input->post()){
            $array=array(
                'nip_guru'=> $this->input->post('nip_guru'),
                'nama_kelas_belajar'=> $this->input->post('nama_kelas_belajar'),
                'kd_kelas'=> $this->input->post('kd_kelas'),
                'status_kelas'=>$this->input->post('status_kelas'),
                'id_tahun'=>$this->input->post('id_tahun'),
                'jenjang'=>$this->input->post('jenjang'),
                'tingkat'=>$this->input->post('tingkatan')
                );
            $exec = $this->m_presensi->tambahdata($array);
            if ($exec) redirect(base_url("admin/datamaster/aturkelasbelajar?msg=1"));
            else redirect(base_url("admin/datamaster/aturkelasbelajar?msg=0"));
        } else {
            $variabel['ruangkelas']=$this->m_kelas->lihatdata();
            $variabel['tahunajaran']=$this->m_tahun_ajaran->lihatdata();
            $variabel['guru']=$this->m_guru->lihatdata();
            $variabel['jenjang']=$this->m_jenjang->lihatdata();
            $this->layout->render('back-end/presensi/presensi_kelas/v_presensi_atur',$variabel,'back-end/presensi/presensi_kelas/v_preskelas_js');
        }
   }

   function hapuskelasbelajar()
    {
       $id = $this->input->get("id");
       $exec = $this->m_presensi->hapus($id);
       redirect(base_url()."admin/datamaster/datakelasbelajar?msg=1");
    }

    function editkelasbelajar()
    {
        if ($this->input->post()) {
            $array=array(
                'nip_guru'=> $this->input->post('nip_guru'),
                'nama_kelas_belajar'=> $this->input->post('nama_kelas_belajar'),
                'kd_kelas'=> $this->input->post('kd_kelas'),
                'status_kelas'=>$this->input->post('status_kelas'),
                'id_tahun'=>$this->input->post('id_tahun'),
                'jenjang'=>$this->input->post('jenjang'),
                'tingkat'=>$this->input->post('tingkatan')
                );
            $id_kelas_belajar = $this->input->post("id_kelas_belajar");
            $exec = $this->m_presensi->editdata($id_kelas_belajar,$array);
            if ($exec){
                redirect(base_url("admin/datamaster/editkelasbelajar?id=".$id_kelas_belajar."&msg=1"));
            }
      } else {
            $id_kelas_belajar = $this->input->get("id");
            $exec = $this->m_presensi->lihatdatasatu($id_kelas_belajar);
            if ($exec->num_rows()>0){
                $variabel['ruangkelas']=$this->m_kelas->lihatdata();
                $variabel['tahunajaran']=$this->m_tahun_ajaran->lihatdata();
                $variabel['guru']=$this->m_guru->lihatdata();
                $variabel['data'] = $exec->row_array();
                $variabel['jenjang']=$this->m_jenjang->lihatdata();
                $variabel['tingkatan']=$this->m_jenjang->lihatdatatingkatan($variabel['data']['jenjang']);
                $this->layout->render('back-end/presensi/presensi_kelas/v_presensi_edit',$variabel,'back-end/presensi/presensi_kelas/v_preskelas_js');
            } else {
                redirect(base_url("admin/datamaster/datakelasbelajar"));
            }
      }


    }


    function lihatkelasbelajar()
    {
        $id_kelas_belajar = $this->input->get("id");
        $exec = $this->m_presensi->lihatdatasatulengkap($id_kelas_belajar);
        if ($exec->num_rows()>0){
            $variabel['data'] = $exec->row_array();
            $variabel['santri'] = $this->m_presensi->lihatdatasantri($id_kelas_belajar);
            $this->layout->render('back-end/presensi/presensi_kelas/v_presensi_lihat',$variabel,'back-end/presensi/presensi_kelas/v_preskelas_js');
        } else {
            redirect(base_url("admin/datamaster/datakelasbelajar"));
        }
    }

    function hapuskelassantri()
    {
       $id = $this->input->get("id");
       $idkelas = $this->input->get("idkelas");
       $exec = $this->m_presensi->hapussantri($id);
       redirect(base_url()."admin/datamaster/lihatkelasbelajarsantri?id=".$idkelas."&h=1");
    }

    function lihatkelasbelajarsantri()
    {
        $id = $this->input->get("id");
        $exec = $this->m_presensi->lihatdatasatulengkap($id);
        if ($exec->num_rows()>0){
            $variabel['santri'] = $exec->row_array();
            $variabel['data'] = $this->m_presensi->lihatdatasantri($id);
            $this->layout->render('back-end/presensi/presensi_kelas/v_santri',$variabel,'back-end/presensi/presensi_kelas/v_santri_js');
        } else {
            redirect(base_url("admin/datamaster/datakelasbelajar"));
        }
    }

    function kelastambahsantri()
    {
        $idkelasbelajar = $this->input->post("id_kelas_belajar");
        $variabel['lissantri'] = $this->m_presensi->lissantri($idkelasbelajar);
        $this->load->view("back-end/presensi/presensi_kelas/v_santri_tambah",$variabel);

    }
    function tambahsantriproses()
    {
        $idkelasbelajar = $this->input->post("idkelasbelajar");
        $nis = $this->input->post("nis");
        $array = array (
            "id_kelas_belajar"=>$idkelasbelajar,
            "nis_lokal"=>$nis
        );
        $exec = $this->m_presensi->tambahdatasantri($array);

    }
    function kelaseditsantri()
    {
        $idkelasbelajar = $this->input->post("id_kelas_belajar");
        $variabel['lissantri'] = $this->m_presensi->lissantri($idkelasbelajar);
        $id_kelas_santri = $this->input->post("id");
        $variabel['data'] = $this->m_presensi->lihatdatasatusantri($id_kelas_santri)->row_array();
        $this->load->view("back-end/presensi/presensi_kelas/v_santri_edit",$variabel);

    }

    function editsantriproses()
    {
        $idkelasbelajar = $this->input->post("idkelasbelajar");
        $nis = $this->input->post("nis");
        $id_kelas_santri = $this->input->post("id_kelas_santri");
        $array = array (
            "nis_lokal"=>$nis
        );
        $exec = $this->m_presensi->editdatasantri($id_kelas_santri,$array);
    }

    function kelaseditbelajar()
    {
        $idkelasbelajar = $this->input->post("id");
        $variabel['data'] = $this->m_presensi->lihatdatasatu($idkelasbelajar)->row_array();
        $this->load->view("back-end/presensi/presensi_kelas/v_presensi_editstatus",$variabel);

    }

    function editkelasproses()
    {
        $id_kelas_belajar = $this->input->post("id_kelas_belajar");
        $status_kelas = $this->input->post("status_kelas");
        $array = array (
            "status_kelas"=>$status_kelas
        );
        $exec = $this->m_presensi->editdata($id_kelas_belajar,$array);
    }

   //CRUD Pelajaran
      function pelajaran(){
           $variabel['data'] = $this->m_pelajaran->lihatdata();
           $this->layout->render('back-end/presensi/presensi_pelajaran/v_pelajaran',$variabel,'back-end/presensi/presensi_pelajaran/v_pelajaran_js');
      }

       function pelajaranlihat()
       {
           $id_pelajaran = $this->input->get("id_pelajaran");
           $exec = $this->m_pelajaran->lihatdatasatu($id_pelajaran);
           if ($exec->num_rows()>0){
               $variabel['data'] = $exec ->row_array();
               $this->layout->render('back-end/presensi/presensi_pelajaran/v_pelajaran_lihat',$variabel,'back-end/presensi/presensi_pelajaran/v_pelajaran_js');
           } else
               redirect(base_url("admin/datamaster/pelajaran"));
       }
       function pelajarantambah()
       {
           if ($this->input->post()){
                 $array=array(
                     'id_pelajaran'=> NULL,
                     'nip_guru'=> $this->input->post('nip_guru'),
                     'id_mata_pelajaran'=> $this->input->post('id_mata_pelajaran')
                     );

                   $exec = $this->m_pelajaran->tambahdata($array);
                   if ($exec) redirect(base_url("admin/datamaster/pelajarantambah?msg=1"));
                   else redirect(base_url("admin/datamaster/pelajarantambah?msg=0"));
           } else {
               //$variabel ='';
               $variabel['nip_guru']=$this->m_pelajaran->ambilguru();
               $variabel['id_mata_pelajaran']=$this->m_pelajaran->ambilmatpel();
               $this->layout->render('back-end/presensi/presensi_pelajaran/v_pelajaran_tambah',$variabel,'back-end/presensi/presensi_pelajaran/v_pelajaran_js');
           }
       }

       function pelajaranedit()
       {
           if ($this->input->post()) {
               $kode = $this->input->post('id_pelajaran');
               $array=array(
                 'nip_guru'=> $this->input->post('nip_guru'),
                 'id_mata_pelajaran'=> $this->input->post('id_mata_pelajaran')
                   );

                   $exec = $this->m_pelajaran->editdata($kode,$array);
                   if ($exec)
                     redirect(base_url("admin/datamaster/pelajaranedit?id_pelajaran=".$kode."&msg=1"));
                   else
                     redirect(base_url("admin/datamaster/pelajaranedit?id_pelajaran=".$kode."&msg=0"));
           }
           else{
               $kode = $this->input->get("id_pelajaran");
               $exec = $this->m_pelajaran->lihatdatasatu($kode);
               $variabel['nip_guru']=$this->m_pelajaran->ambilguru();
               $variabel['id_mata_pelajaran']=$this->m_pelajaran->ambilmatpel();
               if ($exec->num_rows()>0){
                       $variabel['data'] = $exec ->row_array();
                       $this->layout->render('back-end/presensi/presensi_pelajaran/v_pelajaran_edit',$variabel,'back-end/presensi/presensi_pelajaran/v_pelajaran_js');
               }
               else
                   redirect(base_url("admin/datamaster/pelajaran"));
           }
       }

       function pelajaranhapus()
       {
          $kode = $this->input->get("id_pelajaran");
          $exec = $this->m_pelajaran->hapus($kode);
          redirect(base_url()."admin/datamaster/pelajaran?msg=1");
       }
   //end CRUD pelajaran

   //mulai rekap presensi//

   ///////////////////////////mulai rekap presensi santri kelas afilasi//
   function pelajaranrekap(){
     $tgl = date('Y-m-d');
     $variabel['tanggal'] = $tgl;
     $variabel['data'] = $this->m_rekap_santri->datapelajaran();
     $this->layout->render('back-end/presensi/rekap_presensi/v_data_pelajaran',$variabel,'back-end/presensi/rekap_presensi/v_rekap_js');
   }

   function datarekapsantri(){
     if ($this->input->post()){
       $today = date('Y-m-d');
       $tgl = $this->input->post('tanggal_rekap');
       $kel = $this->input->post('kelas');
       $pel = $this->input->post('pelajaran');
       $variabel['data'] = $this->m_rekap_santri->datakelas($kel,$pel,$tgl);
       $variabel['tanggal'] = $tgl;
       $variabel['kelas'] = $kel;
       $variabel['pelajaran'] = $pel;
       $variabel['santri'] = $this->m_rekap_santri->datasantri($kel,$tgl,$pel);
       $variabel['matpel'] = $this->m_rekap_santri->pelajaran($pel);
       $variabel['namakelas'] = $this->m_rekap_santri->kelas($kel);
       if ($tgl > $today){
         redirect(base_url("admin/datamaster/datarekapsantri?kelas=$kel&pelajaran=$pel&tanggal=$today&psn=0"));
       } else{
       $this->layout->render('back-end/presensi/rekap_presensi/v_data_rekap',$variabel,'back-end/presensi/rekap_presensi/v_rekap_js');}
     } else {
     $tgl = $this->input->get('tanggal');
     $kel = $this->input->get('kelas');
     $pel = $this->input->get('pelajaran');
     $variabel['data'] = $this->m_rekap_santri->datakelas($kel,$pel,$tgl);
     $variabel['tanggal'] = $tgl;
     $variabel['kelas'] = $kel;
     $variabel['pelajaran'] = $pel;
     $variabel['santri'] = $this->m_rekap_santri->datasantri($kel,$tgl,$pel);
     $variabel['matpel'] = $this->m_rekap_santri->pelajaran($pel);
     $variabel['namakelas'] = $this->m_rekap_santri->kelas($kel);
     $this->layout->render('back-end/presensi/rekap_presensi/v_data_rekap',$variabel,'back-end/presensi/rekap_presensi/v_rekap_js');}
   }

   function tambahrekap(){
     if ($this->input->post()){
       $array = array(
         'id_santri' => $this->input->post('nis'),
         'id_pelajaran' => $this->input->post('pel'),
         'id_kelas' => $this->input->post('kel'),
         'status_presensi' => $this->input->post('status'),
         'tanggal_rekap' => $this->input->post('tgl')
       );
     $tgl = $this->input->post('tgl');
     $kel = $this->input->post('kel');
     $pel = $this->input->post('pel');
     $nis = $this->input->post('nis');
     $exec = $this->m_rekap_santri->tambahdata($array);
     if ($exec){
       redirect(base_url("admin/datamaster/datarekapsantri?kelas=$kel&pelajaran=$pel&tanggal=$tgl&msg=1"));
     } else{
       redirect(base_url("admin/datamaster/datarekapsantri?kelas=$kel&pelajaran=$pel&tanggal=$tgl&msg=2"));
     }
     }
   }

   function hapusrekap(){
     $id_rekap = $this->input->get('id');
     $tgl = $this->input->get('tanggal');
     $kel = $this->input->get('kelas');
     $pel = $this->input->get('pelajaran');
     $exec = $this->m_rekap_santri->hapus($id_rekap);
     redirect(base_url("admin/datamaster/datarekapsantri?kelas=$kel&pelajaran=$pel&tanggal=$tgl&psn=1"));
   }

   function laporanrekapharian(){
     $tgl = $this->input->get('tanggal');
     $kel = $this->input->get('kelas');
     $pel = $this->input->get('pelajaran');
     $variabel['data'] = $this->m_rekap_santri->datakelas($kel,$pel,$tgl);
     $variabel['tanggal'] = $tgl;
     $variabel['kelas'] = $kel;
     $variabel['pelajaran'] = $pel;
     $variabel['namakelas'] = $this->m_rekap_santri->kelas($kel);
     $variabel['matpel'] = $this->m_rekap_santri->pelajaran($pel);
     $variabel['santrihadir'] = $this->m_rekap_santri->totalhadir($kel,$pel,$tgl);
     $variabel['santriizin'] = $this->m_rekap_santri->totalizin($kel,$pel,$tgl);
     $variabel['santrisakit'] = $this->m_rekap_santri->totalsakit($kel,$pel,$tgl);
     $variabel['santrialfa'] = $this->m_rekap_santri->totalalfa($kel,$pel,$tgl);
       $this->layout->renderlaporan('back-end/presensi/rekap_presensi/v_lap_rekap_harian',$variabel,'back-end/presensi/rekap_presensi/v_rekap_js');
   }
   /////////////////////////////////////////rekap pondokan///////////////////////////////////
   function pondokanrekap(){
     $tgl = date('Y-m-d');
     $variabel['tanggal'] = $tgl;
     $variabel['data'] = $this->m_rekap_santri_pondokan->datapelajaran();
     $this->layout->render('back-end/presensi/rekap_presensi_pondokan/v_data_pondokan',$variabel,'back-end/presensi/rekap_presensi_pondokan/v_rekap_js');
   }

   function datarekapsantripondokan(){
     if ($this->input->post()){
       $today = date('Y-m-d');
       $tgl = $this->input->post('tanggal_rekap');
       $kel = $this->input->post('kelas');
       $pel = $this->input->post('pelajaran');
       $variabel['data'] = $this->m_rekap_santri_pondokan->datakelas($kel,$pel,$tgl);
       $variabel['tanggal'] = $tgl;
       $variabel['kelas'] = $kel;
       $variabel['pelajaran'] = $pel;
       $variabel['santri'] = $this->m_rekap_santri_pondokan->datasantri($kel,$tgl,$pel);
       $variabel['matpel'] = $this->m_rekap_santri_pondokan->pelajaran($pel);
       $variabel['namakelas'] = $this->m_rekap_santri_pondokan->kelas($kel);
       if ($tgl > $today){
         redirect(base_url("admin/datamaster/datarekapsantripondokan?kelas=$kel&pelajaran=$pel&tanggal=$today&psn=0"));
       } else{
       $this->layout->render('back-end/presensi/rekap_presensi_pondokan/v_data_rekap_pondokan',$variabel,'back-end/presensi/rekap_presensi_pondokan/v_rekap_js');}
     } else {
     $tgl = $this->input->get('tanggal');
     $kel = $this->input->get('kelas');
     $pel = $this->input->get('pelajaran');
     $variabel['data'] = $this->m_rekap_santri_pondokan->datakelas($kel,$pel,$tgl);
     $variabel['tanggal'] = $tgl;
     $variabel['kelas'] = $kel;
     $variabel['pelajaran'] = $pel;
     $variabel['santri'] = $this->m_rekap_santri_pondokan->datasantri($kel,$tgl,$pel);
     $variabel['matpel'] = $this->m_rekap_santri_pondokan->pelajaran($pel);
     $variabel['namakelas'] = $this->m_rekap_santri_pondokan->kelas($kel);
     $this->layout->render('back-end/presensi/rekap_presensi_pondokan/v_data_rekap_pondokan',$variabel,'back-end/presensi/rekap_presensi_pondokan/v_rekap_js');}
   }

   function hapusrekappondokan(){
     $id_rekap = $this->input->get('id');
     $tgl = $this->input->get('tanggal');
     $kel = $this->input->get('kelas');
     $pel = $this->input->get('pelajaran');
     $exec = $this->m_rekap_santri_pondokan->hapus($id_rekap);
     redirect(base_url("admin/datamaster/datarekapsantripondokan?kelas=$kel&pelajaran=$pel&tanggal=$tgl&psn=1"));
   }

   function tambahrekappondokan(){
     if ($this->input->post()){
       $array = array(
         'id_santri' => $this->input->post('nis'),
         'id_pelajaran' => $this->input->post('pel'),
         'id_kelas' => $this->input->post('kel'),
         'status_presensi' => $this->input->post('status'),
         'tanggal_rekap' => $this->input->post('tgl')
       );
     $tgl = $this->input->post('tgl');
     $kel = $this->input->post('kel');
     $pel = $this->input->post('pel');
     $nis = $this->input->post('nis');
     $exec = $this->m_rekap_santri_pondokan->tambahdata($array);
     if ($exec){
       redirect(base_url("admin/datamaster/datarekapsantripondokan?kelas=$kel&pelajaran=$pel&tanggal=$tgl&msg=1"));
     } else{
       redirect(base_url("admin/datamaster/datarekapsantripondokan?kelas=$kel&pelajaran=$pel&tanggal=$tgl&msg=2"));
     }
     }
   }

   function laporanrekapharianpondokan(){
     $tgl = $this->input->get('tanggal');
     $kel = $this->input->get('kelas');
     $pel = $this->input->get('pelajaran');
     $variabel['data'] = $this->m_rekap_santri_pondokan->datakelas($kel,$pel,$tgl);
     $variabel['tanggal'] = $tgl;
     $variabel['kelas'] = $kel;
     $variabel['pelajaran'] = $pel;
     $variabel['namakelas'] = $this->m_rekap_santri_pondokan->kelas($kel);
     $variabel['matpel'] = $this->m_rekap_santri_pondokan->pelajaran($pel);
     $variabel['santrihadir'] = $this->m_rekap_santri_pondokan->totalhadir($kel,$pel,$tgl);
     $variabel['santriizin'] = $this->m_rekap_santri_pondokan->totalizin($kel,$pel,$tgl);
     $variabel['santrisakit'] = $this->m_rekap_santri_pondokan->totalsakit($kel,$pel,$tgl);
     $variabel['santrialfa'] = $this->m_rekap_santri_pondokan->totalalfa($kel,$pel,$tgl);
       $this->layout->renderlaporan('back-end/presensi/rekap_presensi_pondokan/v_lap_rekap_harian',$variabel,'back-end/presensi/rekap_presensi_pondokan/v_rekap_js');
   }
   //akhir rekap presensi santri//

   //mulai rekap guru//
   //afiliasi//
   function datarekapguru(){
     $pel = $this->input->get('pelajaran');
     $kel = $this->input->get('kelas');
     $tgl = $this->input->get('tanggal');
     $nip = $this->input->get('guru');
      $variabel['data'] = $this->m_rekap_guru->rekapguru($pel,$kel);
      $variabel['tanggal'] = $tgl;
      $variabel['kelas'] = $kel;
      $variabel['pelajaran'] = $pel;
      $variabel['nip_guru'] =$nip;
      $variabel['namakelas'] = $this->m_rekap_guru->kelas($kel);
      $variabel['matpel'] = $this->m_rekap_guru->pelajaran($pel);
      $variabel['guru'] = $this->m_rekap_guru->dataguru($nip);
      $this->layout->render('back-end/presensi/rekap_presensi/v_data_rekap_guru',$variabel,'back-end/presensi/rekap_presensi/v_rekap_js');
   }

   function tambahrekapguru(){
     if ($this->input->post()){
       $array = array(
         'id_pelajaran' => $this->input->post('pel'),
         'id_kelas' => $this->input->post('kel'),
         'status_presensi' => $this->input->post('status'),
         'nip_guru' => $this->input->post('nip'),
         'tanggal_rekap' => $this->input->post('tanggal_rekap')
       );
      $today = date('Y-m-d');
      $tglr = $this->input->post('tanggal_rekap');
     $tgl = $this->input->post('tgl');
     $kel = $this->input->post('kel');
     $pel = $this->input->post('pel');
     $jdw = $this->input->post('jdw');
     $nip = $this->input->post('nip');
     if ($tglr > $today) {
       redirect(base_url("admin/datamaster/datarekapguru?kelas=$kel&pelajaran=$pel&tanggal=$tgl&guru=$nip&psn=0"));
     } else{
       $exec = $this->m_rekap_guru->tambahdata($array);
       if ($exec){
         redirect(base_url("admin/datamaster/datarekapguru?kelas=$kel&pelajaran=$pel&tanggal=$tgl&guru=$nip&msg=1"));
       } else{
         redirect(base_url("admin/datamaster/datarekapguru?kelas=$kel&pelajaran=$pel&tanggal=$tgl&guru=$nip&msg=0"));
       }
      }
     }
   }

   function hapusrekapguru(){
     $id_rekap = $this->input->get('id');
     $jdw = $this->input->get('jadwal');
     $tgl = $this->input->get('tanggal');
     $kel = $this->input->get('kelas');
     $pel = $this->input->get('pelajaran');
     $nip = $this->input->get('guru');
     $exec = $this->m_rekap_guru->hapus($id_rekap);
     redirect(base_url("admin/datamaster/datarekapguru?kelas=$kel&pelajaran=$pel&tanggal=$tgl&jadwal=$jdw&guru=$nip&psn=1"));
   }

   function laporanrekapguru(){
     $jdw = $this->input->get('jadwal');
     $tgl = $this->input->get('tanggal');
     $kel = $this->input->get('kelas');
     $pel = $this->input->get('pelajaran');
     $nip = $this->input->get('guru');
      $variabel['data'] = $this->m_rekap_guru->rekapguru($pel,$kel);
      $variabel['tanggal'] = $tgl;
      $variabel['kelas'] = $kel;
      $variabel['pelajaran'] = $pel;
      $variabel['jadwal'] = $jdw;
      $variabel['nip_guru'] =$nip;
      $variabel['namakelas'] = $this->m_rekap_guru->kelas($kel);
      $variabel['matpel'] = $this->m_rekap_guru->pelajaran($pel);
      $variabel['guru'] = $this->m_rekap_guru->dataguru($nip);
      $variabel['guruhadir'] = $this->m_rekap_guru->totalhadir($pel,$kel);
      $variabel['guruizin'] = $this->m_rekap_guru->totalizin($pel,$kel);
      $variabel['gurusakit'] = $this->m_rekap_guru->totalsakit($pel,$kel);
      $variabel['gurualfa'] = $this->m_rekap_guru->totalalfa($pel,$kel);
      $this->layout->renderlaporan('back-end/presensi/rekap_presensi/v_lap_rekap_guru',$variabel,'back-end/presensi/rekap_presensi/v_rekap_js');
   }


   //pondokan//
   function datarekapgurupondokan(){
     $pel = $this->input->get('pelajaran');
     $kel = $this->input->get('kelas');
     $tgl = $this->input->get('tanggal');
     $nip = $this->input->get('guru');
      $variabel['data'] = $this->m_rekap_guru_pondokan->rekapguru($pel,$kel);
      $variabel['tanggal'] = $tgl;
      $variabel['kelas'] = $kel;
      $variabel['pelajaran'] = $pel;
      $variabel['nip_guru'] =$nip;
      $variabel['namakelas'] = $this->m_rekap_guru_pondokan->kelas($kel);
      $variabel['matpel'] = $this->m_rekap_guru_pondokan->pelajaran($pel);
      $variabel['guru'] = $this->m_rekap_guru_pondokan->dataguru($nip);
      $this->layout->render('back-end/presensi/rekap_presensi_pondokan/v_data_rekap_guru',$variabel,'back-end/presensi/rekap_presensi_pondokan/v_rekap_js');
   }

   function tambahrekapgurupondokan(){
     if ($this->input->post()){
       $array = array(
         'id_pelajaran' => $this->input->post('pel'),
         'id_kelas' => $this->input->post('kel'),
         'status_presensi' => $this->input->post('status'),
         'nip_guru' => $this->input->post('nip'),
         'tanggal_rekap' => $this->input->post('tanggal_rekap')
       );
      $today = date('Y-m-d');
      $tglr = $this->input->post('tanggal_rekap');
     $tgl = $this->input->post('tgl');
     $kel = $this->input->post('kel');
     $pel = $this->input->post('pel');
     $jdw = $this->input->post('jdw');
     $nip = $this->input->post('nip');
     if ($tglr > $today) {
       redirect(base_url("admin/datamaster/datarekapgurupondokan?kelas=$kel&pelajaran=$pel&tanggal=$tgl&guru=$nip&psn=0"));
     } else{
       $exec = $this->m_rekap_guru_pondokan->tambahdata($array);
       if ($exec){
         redirect(base_url("admin/datamaster/datarekapgurupondokan?kelas=$kel&pelajaran=$pel&tanggal=$tgl&guru=$nip&msg=1"));
       } else{
         redirect(base_url("admin/datamaster/datarekapgurupondokan?kelas=$kel&pelajaran=$pel&tanggal=$tgl&guru=$nip&msg=0"));
       }
      }
     }
   }

   function hapusrekapgurupondokan(){
     $id_rekap = $this->input->get('id');
     $jdw = $this->input->get('jadwal');
     $tgl = $this->input->get('tanggal');
     $kel = $this->input->get('kelas');
     $pel = $this->input->get('pelajaran');
     $nip = $this->input->get('guru');
     $exec = $this->m_rekap_guru_pondokan->hapus($id_rekap);
     redirect(base_url("admin/datamaster/datarekapgurupondokan?kelas=$kel&pelajaran=$pel&tanggal=$tgl&jadwal=$jdw&guru=$nip&psn=1"));
   }

   function laporanrekapgurupondokan(){
     $jdw = $this->input->get('jadwal');
     $tgl = $this->input->get('tanggal');
     $kel = $this->input->get('kelas');
     $pel = $this->input->get('pelajaran');
     $nip = $this->input->get('guru');
      $variabel['data'] = $this->m_rekap_guru_pondokan->rekapguru($pel,$kel);
      $variabel['tanggal'] = $tgl;
      $variabel['kelas'] = $kel;
      $variabel['pelajaran'] = $pel;
      $variabel['jadwal'] = $jdw;
      $variabel['nip_guru'] =$nip;
      $variabel['namakelas'] = $this->m_rekap_guru_pondokan->kelas($kel);
      $variabel['matpel'] = $this->m_rekap_guru_pondokan->pelajaran($pel);
      $variabel['guru'] = $this->m_rekap_guru_pondokan->dataguru($nip);
      $variabel['guruhadir'] = $this->m_rekap_guru_pondokan->totalhadir($pel,$kel);
      $variabel['guruizin'] = $this->m_rekap_guru_pondokan->totalizin($pel,$kel);
      $variabel['gurusakit'] = $this->m_rekap_guru_pondokan->totalsakit($pel,$kel);
      $variabel['gurualfa'] = $this->m_rekap_guru_pondokan->totalalfa($pel,$kel);
      $this->layout->renderlaporan('back-end/presensi/rekap_presensi_pondokan/v_lap_rekap_guru',$variabel,'back-end/presensi/rekap_presensi_pondokan/v_rekap_js');
   }
   //akhir rekap guru//
/////////////////////////////////akhir presensi/////////////////////////////////////////////////////


////////////////////////////////////////////////// pembayaran SPP ////////////////////////////////////////////////////
  function databayarinfaq(){
    if($this->input->post()){
      $tahun = $this->input->post('tahun');
      $bulan = $this->input->post('bulan');
      $variabel['bulan'] = $bulan;
      $variabel['tahun'] = $tahun;
      $variabel['data'] = $this->m_infaq->lihatdata($tahun,$bulan);
      $this->layout->render('back-end/infaq/v_data_infaq',$variabel,'back-end/infaq/v_infaq_js');}
      else {
        $tahun = date('Y');
        $bulan = date('m');
        $variabel['bulan'] = $bulan;
        $variabel['tahun'] = $tahun;
        $variabel['data'] = $this->m_infaq->lihatdata($tahun,$bulan);
        $this->layout->render('back-end/infaq/v_data_infaq',$variabel,'back-end/infaq/v_infaq_js');
      }
    }

  function detilinfaq(){
    $nis = $this->input->get('nis');
    $variabel['nama_santri'] = $this->m_infaq->lihatsantrisatu($nis);
    $variabel['data'] = $this->m_infaq->detilinfaq($nis);
    $this->layout->render('back-end/infaq/v_detil_infaq',$variabel,'back-end/infaq/v_infaq_js');
  }

  function bayarinfaq(){
    if($this->input->post()){
      $array = array(
        'nis_santri' => $this->input->post('id_santri'),
        'tanggal_bayar' => date('Y-m-d'),
        'spp_bulan' => $this->input->post('bulan'),
        'spp_tahun' => $this->input->post('tahun'),
        'status_bayar' => 'lunas',
        'petugas' => $this->session->userdata('nama_akun')
      );
      $exec = $this->m_infaq->tambahdata($array);
      if($exec){
        redirect(base_url("admin/datamaster/bayarinfaq?msg=1"));
      } else{
        redirect(base_url("admin/datamaster/bayarinfaq?msg=0"));
      }
    }else{
      $variabel['daftarsantri'] = $this->m_infaq->datasantri();
      $this->layout->render('back-end/infaq/v_bayar_infaq',$variabel,'back-end/infaq/v_infaq_js');
    }

  }

  function hapusinfaq(){
    $id_infaq = $this->input->get("id_infaq");
    $exec = $this->m_infaq->hapus($id_infaq);
    redirect(base_url()."admin/datamaster/databayarinfaq?msg=1");
  }
  function laporaninfaq(){
    $tahun = $this->input->post('tahun_lap');
    $bulan = $this->input->post('bulan_lap');
    $variabel['bulan'] = $bulan;
    $variabel['tahun'] = $tahun;
    $variabel['santribayar'] = $this->m_infaq->santribayar($tahun,$bulan);
    $variabel['data'] = $this->m_infaq->lihatdata($tahun,$bulan);
    $this->layout->renderlaporan('back-end/infaq/v_lap_infaq',$variabel,'back-end/infaq/v_infaq_js');
  }
  //////////////////////////////////////////akhir pembayaran spp/////////////////////////////////////////

  ////////////////////////////////////////////////prestasi dan pelanggaran/////////////////////////////////////
  /////////////////prestasi///////////////////
  function prestasisantri(){
    $nis = $this->input->get('nis');
    $exec = $this->m_santri->lihatdatasatu($nis);
    if ($exec->num_rows()>0){
      $variabel['santri'] = $exec->row_array();
      $variabel['data'] = $this->m_prestasi->lihatdata($nis);
      $this->layout->render('back-end/prestasi_pelanggaran/v_data_prestasi',$variabel,'back-end/prestasi_pelanggaran/prestasi_pelanggaran_js');
    } else {
      redirect(base_url("admin/datamaster/santri"));
    }
  }

  function tambahprestasi(){
    if($this->input->post()){
      $nis = $this->input->post('nis_santri');
      $array = array(
        'nis_santri' => $this->input->post('nis_santri'),
        'tanggal_prestasi' =>  $this->input->post('tanggal_prestasi'),
        'jenis_prestasi' => $this->input->post('jenis_prestasi'),
        'prestasi' => $this->input->post('nama_prestasi'),

        'keterangan' => $this->input->post('keterangan')
      );
      $exec = $this->m_prestasi->tambahdata($array);
      if($exec){
        redirect(base_url("admin/datamaster/tambahprestasi?nis=$nis&msg=1"));
      } else{
        redirect(base_url("admin/datamaster/tambahprestasi?nis=$nis&msg=0"));
      }
    } else {
        $nis = $this->input->get('nis');
        $exec = $this->m_santri->lihatdatasatu($nis);
        $variabel['santri'] = $exec->row_array();
        $variabel['nis_santri'] = $nis;
        $this->layout->render('back-end/prestasi_pelanggaran/v_prestasi_tambah',$variabel,'back-end/prestasi_pelanggaran/prestasi_pelanggaran_js');
    }
  }

  function ubahprestasi(){
    if($this->input->post()){
      $id = $this->input->post('id_prestasi');
      $nis = $this->input->post('nis_santri');
      $array = array(
        'tanggal_prestasi' =>  $this->input->post('tanggal_prestasi'),
        'jenis_prestasi' => $this->input->post('jenis_prestasi'),
        'prestasi' => $this->input->post('nama_prestasi'),

        'keterangan' => $this->input->post('keterangan')
      );
      $exec = $this->m_prestasi->editdata($id,$array);
      if($exec){
        redirect(base_url("admin/datamaster/ubahprestasi?nis=$nis&id=$id&msg=1"));
      } else{
        redirect(base_url("admin/datamaster/ubahprestasi?nis=$nis&id=$id&msg=0"));
      }
    } else {
      $id = $this->input->get('id');
      $nis = $this->input->get('nis');
      $exec = $this->m_santri->lihatdatasatu($nis);
        if ($exec->num_rows()>0){
      $exec2 = $this->m_prestasi->ambildata($id);
      $variabel['santri'] = $exec->row_array();
      $variabel['data'] = $exec2->row_array();
      $this->layout->render('back-end/prestasi_pelanggaran/v_prestasi_ubah',$variabel,'back-end/prestasi_pelanggaran/prestasi_pelanggaran_js');
    } else{
      redirect(base_url("admin/datamaster/santri"));
    }
    }

  }

  function hapusprestasi(){
    $id = $this->input->get("id");
    $nis = $this->input->get('nis');
    $exec = $this->m_prestasi->hapus($id);
    redirect(base_url()."admin/datamaster/prestasisantri?nis=$nis&msg=1");
  }

//////////////////pelanggaran////////////////////////
function pelanggaransantri(){
  $nis = $this->input->get('nis');
  $exec = $this->m_santri->lihatdatasatu($nis);
  if ($exec->num_rows()>0){
    $variabel['santri'] = $exec->row_array();
    $variabel['data'] = $this->m_pelanggaran->lihatdata($nis);
    $this->layout->render('back-end/prestasi_pelanggaran/v_data_pelanggaran',$variabel,'back-end/prestasi_pelanggaran/prestasi_pelanggaran_js');
  } else {
    redirect(base_url("admin/datamaster/santri"));
  }
}

function tambahpelanggaran(){
  if($this->input->post()){
    $nis = $this->input->post('nis_santri');
    $array = array(
      'nis_santri' => $this->input->post('nis_santri'),
      'tanggal_pelanggaran' =>  $this->input->post('tanggal_pelanggaran'),
      'jenis_pelanggaran' => $this->input->post('jenis_pelanggaran'),
      'pelanggaran' => $this->input->post('nama_pelanggaran'),

      'keterangan' => $this->input->post('keterangan')
    );
    $exec = $this->m_pelanggaran->tambahdata($array);
    if($exec){
      redirect(base_url("admin/datamaster/tambahpelanggaran?nis=$nis&msg=1"));
    } else{
      redirect(base_url("admin/datamaster/tambahpelanggaran?nis=$nis&msg=0"));
    }
  } else {
      $nis = $this->input->get('nis');
      $exec = $this->m_santri->lihatdatasatu($nis);
      $variabel['santri'] = $exec->row_array();
      $variabel['nis_santri'] = $nis;
      $this->layout->render('back-end/prestasi_pelanggaran/v_pelanggaran_tambah',$variabel,'back-end/prestasi_pelanggaran/prestasi_pelanggaran_js');
  }
}

function ubahpelanggaran(){
  if($this->input->post()){
    $id = $this->input->post('id_pelanggaran');
    $nis = $this->input->post('nis_santri');
    $array = array(
      'tanggal_pelanggaran' =>  $this->input->post('tanggal_pelanggaran'),
      'jenis_pelanggaran' => $this->input->post('jenis_pelanggaran'),
      'pelanggaran' => $this->input->post('nama_pelanggaran'),

      'keterangan' => $this->input->post('keterangan')
    );
    $exec = $this->m_pelanggaran->editdata($id,$array);
    if($exec){
      redirect(base_url("admin/datamaster/ubahpelanggaran?nis=$nis&id=$id&msg=1"));
    } else{
      redirect(base_url("admin/datamaster/ubahpelanggaran?nis=$nis&id=$id&msg=0"));
    }
  } else {
    $id = $this->input->get('id');
    $nis = $this->input->get('nis');
    $exec = $this->m_santri->lihatdatasatu($nis);
      if ($exec->num_rows()>0){
    $exec2 = $this->m_pelanggaran->ambildata($id);
    $variabel['santri'] = $exec->row_array();
    $variabel['data'] = $exec2->row_array();
    $this->layout->render('back-end/prestasi_pelanggaran/v_pelanggaran_ubah',$variabel,'back-end/prestasi_pelanggaran/prestasi_pelanggaran_js');
  } else{
    redirect(base_url("admin/datamaster/santri"));
  }
  }

}

function hapuspelanggaran(){
  $id = $this->input->get("id");
  $nis = $this->input->get('nis');
  $exec = $this->m_pelanggaran->hapus($id);
  redirect(base_url()."admin/datamaster/pelanggaransantri?nis=$nis&msg=1");
}
  /////////////////////////////akhir prestasi dan pelanggaran/////////////////////////////////////////////////////////


  function jenjang()
  {
      $variabel['data'] = $this->m_jenjang->lihatdata();
      $this->layout->render('back-end/datamaster/jenjang/v_jenjang',$variabel,'back-end/datamaster/jenjang/v_jenjang_js');
  }

function jenjangtambah()
{
    if ($this->input->post()){
            $array=array(
                'jenjang'=> $this->input->post('jenjang'),
                'namajenjang'=> $this->input->post('namajenjang')
                );
        if ($this->m_jenjang->cekdata($this->input->post('jenjang'))==0) {
            $exec = $this->m_jenjang->tambahdata($array);
            if ($exec) redirect(base_url("admin/datamaster/jenjangtambah?msg=1"));
            else redirect(base_url("admin/datamaster/jenjangtambah?msg=0"));
        } else {
            $variabel['jenjang'] =$this->input->post('jenjang');
            $this->layout->render('back-end/datamaster/jenjang/v_jenjang_tambah',$variabel,'back-end/datamaster/jenjang/v_jenjang_js');
        }

    } else {
        $variabel ='';
        $this->layout->render('back-end/datamaster/jenjang/v_jenjang_tambah',$variabel,'back-end/datamaster/jenjang/v_jenjang_js');
    }
}

function jenjangedit()
    {
        if ($this->input->post()) {
            $array=array(
                'jenjang'=> $this->input->post('jenjang'),
                'namajenjang'=> $this->input->post('namajenjang')
                );
            $jenjang2 = $this->input->post("jenjang2");
            $jenjang = $this->input->post("jenjang");
            if (($this->m_jenjang->cekdata($jenjang)>0) && ($jenjang2!=$jenjang)) {
                $variabel['jenjang'] =$this->input->post('jenjang');
                $variabel['jenjang2'] =$this->input->post('jenjang2');
                $variabel['data'] = $array;
                $this->layout->render('back-end/datamaster/jenjang/v_jenjang_edit',$variabel,'back-end/datamaster/jenjang/v_jenjang_js');
            } else {
                $exec = $this->m_jenjang->editdata($jenjang2,$array);
                if ($exec){
                  redirect(base_url("admin/datamaster/jenjangedit?jenjang=".$jenjang."&msg=1"));
                }
            }
      } else {
            $jenjang = $this->input->get("jenjang");
            $exec = $this->m_jenjang->lihatdatasatu($jenjang);
            if ($exec->num_rows()>0){
                $variabel['data'] = $exec ->row_array();
                $this->layout->render('back-end/datamaster/jenjang/v_jenjang_edit',$variabel,'back-end/datamaster/jenjang/v_jenjang_js');
            } else {
                redirect(base_url("admin/datamaster/jenjang"));
            }
      }

    }

    function jenjanghapus()
    {
       $jenjang = $this->input->get("jenjang");
       $exec = $this->m_jenjang->hapus($jenjang);
       redirect(base_url()."admin/datamaster/jenjang?msg=1");
    }


    function jenjangtingkat()
    {
        $jenjang = $this->input->get("jenjang");
        $exec = $this->m_jenjang->lihatdatasatu($jenjang);
        if ($exec->num_rows()>0){
            $variabel['jenjang'] = $exec->row_array();
            $variabel['data'] = $this->m_jenjang->lihatdatatingkat($jenjang);
            $this->layout->render('back-end/datamaster/jenjang/v_jenjangtingkat',$variabel,'back-end/datamaster/jenjang/v_jenjangtingkat_js');
        } else {
            redirect(base_url("admin/datamaster/jenjang"));
        }

    }

    function jenjangtambahtingkat()
    {
        $jenjang = $this->input->get("jenjang");
        $exec = $this->m_jenjang->lihatdatasatu($jenjang);
        if ($exec->num_rows()>0){
            $variabel['jenjang'] = $exec->row_array();
            if ($this->input->post()){
                $jenjang = $this->input->post('jenjang');
                $tingkat = $this->input->post('tingkat');
                $array=array(
                    'jenjang'=>  $jenjang,
                    'tingkat'=> $tingkat
                );
                $exec = $this->m_jenjang->tambahdatatingkat($array);
                if ($exec) redirect(base_url("admin/datamaster/jenjangtambahtingkat?jenjang=".$jenjang."&msg=1"));
                else redirect(base_url("admin/datamaster/jenjangtambahtingkat?jenjang=".$jenjang."&msg=0"));
            } else {
                $this->layout->render('back-end/datamaster/jenjang/v_jenjangtingkat_tambah',$variabel,'back-end/datamaster/jenjang/v_jenjangtingkat_js');
            }
        } else {
            redirect(base_url("admin/datamaster/jenjang"));
        }
    }

    function jenjanghapustingkat()
    {
        $idtingkatjenjang = $this->input->get("idtingkatjenjang");
        $jenjang = $this->input->get("jenjang");
        $exec = $this->m_jenjang->hapustingkat($idtingkatjenjang);
        redirect(base_url()."admin/datamaster/jenjangtingkat?msg=1&jenjang=".$jenjang."");
    }

    function jenjangedittingkat()
    {
        if ($this->input->post()) {
            $idtingkatjenjang = $this->input->post('idtingkatjenjang');
            $jenjang = $this->input->post('jenjang');
            $tingkat = $this->input->post('tingkat');
            $array=array(
                'tingkat'=> $tingkat
            );
            $exec = $this->m_jenjang->editdatatingkat($idtingkatjenjang,$array);
            if ($exec) redirect(base_url("admin/datamaster/jenjangedittingkat?id=".$idtingkatjenjang."&jenjang=".$jenjang."&msg=1"));
            else redirect(base_url("admin/datamaster/jenjangedittingkat?id=".$idtingkatjenjang."&jenjang=".$jenjang."&msg=0"));
        } else {
            $jenjang = $this->input->get("jenjang");
            $id = $this->input->get("id");
            $exec = $this->m_jenjang->lihatdatasatu($jenjang);
            if ($exec->num_rows()>0){
                $variabel['jenjang'] = $exec ->row_array();
                $exec2 = $this->m_jenjang->lihatdatasatutingkat($id);
                if ($exec2->num_rows()>0){
                    $variabel['data'] = $exec2->row_array();
                    $this->layout->render('back-end/datamaster/jenjang/v_jenjangtingkat_edit',$variabel,'back-end/datamaster/jenjang/v_jenjangtingkat_js');
                } else {
                    redirect(base_url("admin/datamaster/jenjangtingkat?jenjang=$jenjang"));
                }
            } else {
                redirect(base_url("admin/datamaster/jenjang"));
            }
        }

    }

    function datatingkatjenjang()
    {
      $jenjang=$this->input->post('jenjang');
      $data=$this->m_jenjang->datatingkatajax($jenjang);
      echo json_encode($data);
    }

  function pondokan()
  {
      $variabel['data'] = $this->m_pondokan->lihatdata();
      $this->layout->render('back-end/datamaster/pondokan/v_pondokan',$variabel,'back-end/datamaster/pondokan/v_pondokan_js');
  }

function pondokantambah()
{
    if ($this->input->post()){
            $array=array(
                'pondokan'=> $this->input->post('pondokan'),
                'namapondokan'=> $this->input->post('namapondokan')
                );
        if ($this->m_pondokan->cekdata($this->input->post('pondokan'))==0) {
            $exec = $this->m_pondokan->tambahdata($array);
            if ($exec) redirect(base_url("admin/datamaster/pondokantambah?msg=1"));
            else redirect(base_url("admin/datamaster/pondokantambah?msg=0"));
        } else {
            $variabel['pondokan'] =$this->input->post('pondokan');
            $this->layout->render('back-end/datamaster/pondokan/v_pondokan_tambah',$variabel,'back-end/datamaster/pondokan/v_pondokan_js');
        }

    } else {
        $variabel ='';
        $this->layout->render('back-end/datamaster/pondokan/v_pondokan_tambah',$variabel,'back-end/datamaster/pondokan/v_pondokan_js');
    }
}

function pondokanedit()
    {
        if ($this->input->post()) {
            $array=array(
                'pondokan'=> $this->input->post('pondokan'),
                'namapondokan'=> $this->input->post('namapondokan')
                );
            $pondokan2 = $this->input->post("pondokan2");
            $pondokan = $this->input->post("pondokan");
            if (($this->m_pondokan->cekdata($pondokan)>0) && ($pondokan2!=$pondokan)) {
                $variabel['pondokan'] =$this->input->post('pondokan');
                $variabel['pondokan2'] =$this->input->post('pondokan2');
                $variabel['data'] = $array;
                $this->layout->render('back-end/datamaster/pondokan/v_pondokan_edit',$variabel,'back-end/datamaster/pondokan/v_pondokan_js');
            } else {
                $exec = $this->m_pondokan->editdata($pondokan2,$array);
                if ($exec){
                  redirect(base_url("admin/datamaster/pondokanedit?pondokan=".$pondokan."&msg=1"));
                }
            }
      } else {
            $pondokan = $this->input->get("pondokan");
            $exec = $this->m_pondokan->lihatdatasatu($pondokan);
            if ($exec->num_rows()>0){
                $variabel['data'] = $exec ->row_array();
                $this->layout->render('back-end/datamaster/pondokan/v_pondokan_edit',$variabel,'back-end/datamaster/pondokan/v_pondokan_js');
            } else {
                redirect(base_url("admin/datamaster/pondokan"));
            }
      }

    }

    function pondokanhapus()
    {
       $pondokan = $this->input->get("pondokan");
       $exec = $this->m_pondokan->hapus($pondokan);
       redirect(base_url()."admin/datamaster/pondokan?msg=1");
    }


    function pondokantingkat()
    {
        $pondokan = $this->input->get("pondokan");
        $exec = $this->m_pondokan->lihatdatasatu($pondokan);
        if ($exec->num_rows()>0){
            $variabel['pondokan'] = $exec->row_array();
            $variabel['data'] = $this->m_pondokan->lihatdatatingkat($pondokan);
            $this->layout->render('back-end/datamaster/pondokan/v_pondokantingkat',$variabel,'back-end/datamaster/pondokan/v_pondokantingkat_js');
        } else {
            redirect(base_url("admin/datamaster/pondokan"));
        }

    }

    function pondokantambahtingkat()
    {
        $pondokan = $this->input->get("pondokan");
        $exec = $this->m_pondokan->lihatdatasatu($pondokan);
        if ($exec->num_rows()>0){
            $variabel['pondokan'] = $exec->row_array();
            if ($this->input->post()){
                $pondokan = $this->input->post('pondokan');
                $tingkat = $this->input->post('tingkat');
                $array=array(
                    'pondokan'=>  $pondokan,
                    'tingkat'=> $tingkat
                );
                $exec = $this->m_pondokan->tambahdatatingkat($array);
                if ($exec) redirect(base_url("admin/datamaster/pondokantambahtingkat?pondokan=".$pondokan."&msg=1"));
                else redirect(base_url("admin/datamaster/pondokantambahtingkat?pondokan=".$pondokan."&msg=0"));
            } else {
                $this->layout->render('back-end/datamaster/pondokan/v_pondokantingkat_tambah',$variabel,'back-end/datamaster/pondokan/v_pondokantingkat_js');
            }
        } else {
            redirect(base_url("admin/datamaster/pondokan"));
        }
    }

    function pondokanhapustingkat()
    {
        $idtingkatpondokan = $this->input->get("idtingkatpondokan");
        $pondokan = $this->input->get("pondokan");
        $exec = $this->m_pondokan->hapustingkat($idtingkatpondokan);
        redirect(base_url()."admin/datamaster/pondokantingkat?msg=1&pondokan=".$pondokan."");
    }

    function pondokanedittingkat()
    {
        if ($this->input->post()) {
            $idtingkatpondokan = $this->input->post('idtingkatpondokan');
            $pondokan = $this->input->post('pondokan');
            $tingkat = $this->input->post('tingkat');
            $array=array(
                'tingkat'=> $tingkat
            );
            $exec = $this->m_pondokan->editdatatingkat($idtingkatpondokan,$array);
            if ($exec) redirect(base_url("admin/datamaster/pondokanedittingkat?id=".$idtingkatpondokan."&pondokan=".$pondokan."&msg=1"));
            else redirect(base_url("admin/datamaster/pondokanedittingkat?id=".$idtingkatpondokan."&pondokan=".$pondokan."&msg=0"));
        } else {
            $pondokan = $this->input->get("pondokan");
            $id = $this->input->get("id");
            $exec = $this->m_pondokan->lihatdatasatu($pondokan);
            if ($exec->num_rows()>0){
                $variabel['pondokan'] = $exec ->row_array();
                $exec2 = $this->m_pondokan->lihatdatasatutingkat($id);
                if ($exec2->num_rows()>0){
                    $variabel['data'] = $exec2->row_array();
                    $this->layout->render('back-end/datamaster/pondokan/v_pondokantingkat_edit',$variabel,'back-end/datamaster/pondokan/v_pondokantingkat_js');
                } else {
                    redirect(base_url("admin/datamaster/pondokantingkat?pondokan=$pondokan"));
                }
            } else {
                redirect(base_url("admin/datamaster/pondokan"));
            }
        }

    }

    function datatingkatpondokan()
    {
      $pondokan=$this->input->post('pondokan');
      $data=$this->m_pondokan->datatingkatajax($pondokan);
      echo json_encode($data);
    }



    function datakelaspondokan()
   {
      $variabel['data']=$this->m_presensipondokan->lihatdata();
      $this->layout->render('back-end/presensi/presensi_pondokan/v_presensi_pondokan',$variabel,'back-end/presensi/presensi_pondokan/v_preskelas_js');
   }

   function aturkelaspondokan(){
    if ($this->input->post()){
        $array=array(
            'nip_guru'=> $this->input->post('nip_guru'),
            'nama_kelas_belajar'=> $this->input->post('nama_kelas_belajar'),
            'kd_kelas'=> $this->input->post('kd_kelas'),
            'status_kelas'=>$this->input->post('status_kelas'),
            'id_tahun'=>$this->input->post('id_tahun'),
            'pondokan'=>$this->input->post('pondokan'),
            'tingkat'=>$this->input->post('tingkatan')
            );
        $exec = $this->m_presensipondokan->tambahdata($array);
        if ($exec) redirect(base_url("admin/datamaster/aturkelaspondokan?msg=1"));
        else redirect(base_url("admin/datamaster/aturkelaspondokan?msg=0"));
    } else {
        $variabel['ruangkelas']=$this->m_kelas->lihatdata();
        $variabel['tahunajaran']=$this->m_tahun_ajaran->lihatdata();
        $variabel['guru']=$this->m_guru->lihatdata();
        $variabel['pondokan']=$this->m_pondokan->lihatdata();
        $this->layout->render('back-end/presensi/presensi_pondokan/v_presensi_atur',$variabel,'back-end/presensi/presensi_pondokan/v_preskelas_js');
    }
}

function editkelaspondokan()
    {
        if ($this->input->post()) {
            $array=array(
                'nip_guru'=> $this->input->post('nip_guru'),
                'nama_kelas_belajar'=> $this->input->post('nama_kelas_belajar'),
                'kd_kelas'=> $this->input->post('kd_kelas'),
                'status_kelas'=>$this->input->post('status_kelas'),
                'id_tahun'=>$this->input->post('id_tahun'),
                'pondokan'=>$this->input->post('pondokan'),
                'tingkat'=>$this->input->post('tingkatan')
                );
            $id_kelas_belajar = $this->input->post("id_kelas_belajar");
            $exec = $this->m_presensipondokan->editdata($id_kelas_belajar,$array);
            if ($exec){
                redirect(base_url("admin/datamaster/editkelaspondokan?id=".$id_kelas_belajar."&msg=1"));
            }
      } else {
            $id_kelas_belajar = $this->input->get("id");
            $exec = $this->m_presensipondokan->lihatdatasatu($id_kelas_belajar);
            if ($exec->num_rows()>0){
                $variabel['ruangkelas']=$this->m_kelas->lihatdata();
                $variabel['tahunajaran']=$this->m_tahun_ajaran->lihatdata();
                $variabel['guru']=$this->m_guru->lihatdata();
                $variabel['data'] = $exec->row_array();
                $variabel['pondokan']=$this->m_pondokan->lihatdata();
                $variabel['tingkatan']=$this->m_pondokan->lihatdatatingkatan($variabel['data']['pondokan']);
                $this->layout->render('back-end/presensi/presensi_pondokan/v_presensi_edit',$variabel,'back-end/presensi/presensi_pondokan/v_preskelas_js');
            } else {
                redirect(base_url("admin/datamaster/datakelaspondokan"));
            }
      }



    }

    function hapuskelaspondokan()
    {
       $id = $this->input->get("id");
       $exec = $this->m_presensipondokan->hapus($id);
       redirect(base_url()."admin/datamaster/datakelaspondokan?msg=1");
    }

    function lihatkelaspondokan()
    {
        $id_kelas_belajar = $this->input->get("id");
        $exec = $this->m_presensipondokan->lihatdatasatulengkap($id_kelas_belajar);
        if ($exec->num_rows()>0){
            $variabel['data'] = $exec->row_array();
            $variabel['santri'] = $this->m_presensipondokan->lihatdatasantri($id_kelas_belajar);
            $this->layout->render('back-end/presensi/presensi_pondokan/v_presensi_lihat',$variabel,'back-end/presensi/presensi_pondokan/v_preskelas_js');
        } else {
            redirect(base_url("admin/datamaster/datakelaspondokan"));
        }
    }

    function kelaseditpondokan()
    {
        $idkelaspondokan = $this->input->post("id");
        $variabel['data'] = $this->m_presensipondokan->lihatdatasatu($idkelaspondokan)->row_array();
        $this->load->view("back-end/presensi/presensi_pondokan/v_presensi_editstatus",$variabel);

    }

    function editpondokanproses()
    {
        $id_kelas_belajar = $this->input->post("id_kelas_belajar");
        $status_kelas = $this->input->post("status_kelas");
        $array = array (
            "status_kelas"=>$status_kelas
        );
        $exec = $this->m_presensipondokan->editdata($id_kelas_belajar,$array);
    }

    function lihatkelaspondokansantri()
    {
        $id = $this->input->get("id");
        $exec = $this->m_presensipondokan->lihatdatasatulengkap($id);
        if ($exec->num_rows()>0){
            $variabel['santri'] = $exec->row_array();
            $variabel['data'] = $this->m_presensipondokan->lihatdatasantri($id);
            $this->layout->render('back-end/presensi/presensi_pondokan/v_santri',$variabel,'back-end/presensi/presensi_pondokan/v_santri_js');
        } else {
            redirect(base_url("admin/datamaster/datakelaspondokan"));
        }
    }


    function kelastambahsantripondokan()
    {
        $idkelaspondokan = $this->input->post("id_kelas_belajar");
        $variabel['lissantri'] = $this->m_presensipondokan->lissantri($idkelaspondokan);
        $this->load->view("back-end/presensi/presensi_pondokan/v_santri_tambah",$variabel);
    }

    function tambahsantripondokproses()
    {
        $idkelasbelajar = $this->input->post("idkelasbelajar");
        $nis = $this->input->post("nis");
        $array = array (
            "id_kelas_belajar"=>$idkelasbelajar,
            "nis_lokal"=>$nis
        );
        $exec = $this->m_presensipondokan->tambahdatasantri($array);

    }

    function hapuskelassantripondokan()
    {
       $id = $this->input->get("id");
       $idkelas = $this->input->get("idkelas");
       $exec = $this->m_presensipondokan->hapussantri($id);
       redirect(base_url()."admin/datamaster/lihatkelaspondokansantri?id=".$idkelas."&h=1");
    }

    function kelaseditsantripondokan()
    {
        $idkelaspondokan = $this->input->post("id_kelas_belajar");
        $variabel['lissantri'] = $this->m_presensipondokan->lissantri($idkelaspondokan);
        $id_kelas_santri = $this->input->post("id");
        $variabel['data'] = $this->m_presensipondokan->lihatdatasatusantri($id_kelas_santri)->row_array();
        $this->load->view("back-end/presensi/presensi_pondokan/v_santri_edit",$variabel);

    }

    function editsantripondokanproses()
    {
        $idkelaspondokan = $this->input->post("idkelaspondokan");
        $nis = $this->input->post("nis");
        $id_kelas_santri = $this->input->post("id_kelas_santri");
        $array = array (
            "nis_lokal"=>$nis
        );
        $exec = $this->m_presensipondokan->editdatasantri($id_kelas_santri,$array);
    }

    function jadwalpondokan()
    {
        $id = $this->input->get("id");
        $exec = $this->m_presensipondokan->lihatdatasatulengkap($id);
        if ($exec->num_rows()>0) {
            $variabel['jadwal'] = $exec->row_array();
            $variabel['datasenin'] = $this->m_presensipondokan->lihatdatajadwal($id,'Senin');
            $variabel['dataselasa'] = $this->m_presensipondokan->lihatdatajadwal($id,'Selasa');
            $variabel['datarabu'] = $this->m_presensipondokan->lihatdatajadwal($id,'Rabu');
            $variabel['datakamis'] = $this->m_presensipondokan->lihatdatajadwal($id,'Kamis');
            $variabel['datajumat'] = $this->m_presensipondokan->lihatdatajadwal($id,"Jum'at");
            $variabel['datasabtu'] = $this->m_presensipondokan->lihatdatajadwal($id,'Sabtu');
            $variabel['dataahad'] = $this->m_presensipondokan->lihatdatajadwal($id,'Ahad');

            $this->layout->render('back-end/presensi/presensi_pondokan/v_jadwal',$variabel,'back-end/presensi/presensi_pondokan/v_jadwal_js');
        } else {
            redirect(base_url("admin/datamaster/datakelaspondokan"));
        }
    }

    function tambahjadwalpondokan()
    {
        $idkelaspondokan = $this->input->post("id_kelas_belajar");
        $variabel['pelajaran'] = $this->m_pelajaran->lihatdata();
        $variabel['jam'] = $this->m_pak_pondokan->lihatdata();
        $this->load->view("back-end/presensi/presensi_pondokan/v_jadwal_tambah",$variabel);
    }

    function tambahjadwalpondokanproses()
    {
        $idkelasbelajar = $this->input->post("idkelasbelajar");
        $id_pelajaran = $this->input->post("mata_pelajaran");
        $hari = $this->input->post("hari");
        $jam = $this->input->post("jam");


        $array = array (
            "id_kelas_belajar"=>$idkelasbelajar,
            "id_mata_pelajaran"=>$id_pelajaran,
            "hari"=>$hari,
            "jam"=>$jam
        );
        if ($id_pelajaran=="Istirahat"){
            $array["mata_pelajaran"]="Istirahat";
            $array["nip"]="Istirahat";
            $array["guru"]="Istirahat";
        } else {
            $data = $this->m_pelajaran->lihatdatasatu($id_pelajaran)->row_array();
            $array["mata_pelajaran"]=$data['nama_mata_pelajaran'];
            $array["nip"]=$data['nip_guru'];
            $array["guru"]=$data['nama_lengkap'];
        }
        $exec = $this->m_presensipondokan->tambahdatajadwal($array);
    }
    function editjadwalpondokan()
    {
        $idkelaspondokan = $this->input->post("id_kelas_belajar");
        $id_jadwal = $this->input->post("id");

        $variabel['pelajaran'] = $this->m_pelajaran->lihatdata();
        $variabel['jam'] = $this->m_pak_pondokan->lihatdata();

        $variabel['data'] = $this->m_presensipondokan->lihatdatasatujadwal($id_jadwal)->row_array();
        $this->load->view("back-end/presensi/presensi_pondokan/v_jadwal_edit",$variabel);

    }

    function editjadwalpondokanproses()
    {
        $id_jadwal = $this->input->post("idjadwal");

        $idkelasbelajar = $this->input->post("idkelasbelajar");
        $id_pelajaran = $this->input->post("mata_pelajaran");
        $hari = $this->input->post("hari");
        $jam = $this->input->post("jam");

        $array = array (
            "id_mata_pelajaran"=>$id_pelajaran,
            "jam"=>$jam
        );
        if ($id_pelajaran=="Istirahat"){
            $array["mata_pelajaran"]="Istirahat";
            $array["nip"]="Istirahat";
            $array["guru"]="Istirahat";
        } else {
            $data = $this->m_pelajaran->lihatdatasatu($id_pelajaran)->row_array();
            $array["mata_pelajaran"]=$data['nama_mata_pelajaran'];
            $array["nip"]=$data['nip_guru'];
            $array["guru"]=$data['nama_lengkap'];
        }
        $exec = $this->m_presensipondokan->editdatajadwal($id_jadwal,$array);
    }

    function hapusjadwalpondokan()
    {
       $id = $this->input->get("id");
       $idkelas = $this->input->get("idkelas");
       $exec = $this->m_presensipondokan->hapusjadwal($id);
       redirect(base_url()."admin/datamaster/jadwalpondokan?id=".$idkelas."&h=1");
    }

    ////////////////////////////////////////////////
    function jadwalafilasi()
    {
        $id = $this->input->get("id");
        $exec = $this->m_presensi->lihatdatasatulengkap($id);
        if ($exec->num_rows()>0) {
            $variabel['jadwal'] = $exec->row_array();
            $variabel['datasenin'] = $this->m_presensi->lihatdatajadwal($id,'Senin');
            $variabel['dataselasa'] = $this->m_presensi->lihatdatajadwal($id,'Selasa');
            $variabel['datarabu'] = $this->m_presensi->lihatdatajadwal($id,'Rabu');
            $variabel['datakamis'] = $this->m_presensi->lihatdatajadwal($id,'Kamis');
            $variabel['datajumat'] = $this->m_presensi->lihatdatajadwal($id,"Jum'at");
            $variabel['datasabtu'] = $this->m_presensi->lihatdatajadwal($id,'Sabtu');
            $variabel['dataahad'] = $this->m_presensi->lihatdatajadwal($id,'Ahad');
            $this->layout->render('back-end/presensi/presensi_kelas/v_jadwal',$variabel,'back-end/presensi/presensi_kelas/v_jadwal_js');
        } else {
            redirect(base_url("admin/datamaster/datakelasafilasi"));
        }
    }

    function tambahjadwalafilasi()
    {
        $idkelaspondokan = $this->input->post("id_kelas_belajar");
        $variabel['pelajaran'] = $this->m_pelajaran->lihatdata();
        $variabel['jam'] = $this->m_pak_afilasi->lihatdata();
        $this->load->view("back-end/presensi/presensi_kelas/v_jadwal_tambah",$variabel);
    }

    function tambahjadwalafilasiproses()
    {
        $idkelasbelajar = $this->input->post("idkelasbelajar");
        $id_pelajaran = $this->input->post("mata_pelajaran");
        $hari = $this->input->post("hari");
        $jam = $this->input->post("jam");

        $array = array (
            "id_kelas_belajar"=>$idkelasbelajar,
            "id_mata_pelajaran"=>$id_pelajaran,
            "hari"=>$hari,
            "jam"=>$jam
        );

        if ($id_pelajaran=="Istirahat"){
            $array["mata_pelajaran"]="Istirahat";
            $array["nip"]="Istirahat";
            $array["guru"]="Istirahat";
        } else {
            $data = $this->m_pelajaran->lihatdatasatu($id_pelajaran)->row_array();
            $array["mata_pelajaran"]=$data['nama_mata_pelajaran'];
            $array["nip"]=$data['nip_guru'];
            $array["guru"]=$data['nama_lengkap'];
        }
        $exec = $this->m_presensi->tambahdatajadwal($array);

    }
    function editjadwalafilasi()
    {
        $idkelaspondokan = $this->input->post("id_kelas_belajar");
        $id_jadwal = $this->input->post("id");

         $variabel['pelajaran'] = $this->m_pelajaran->lihatdata();
        $variabel['jam'] = $this->m_pak_afilasi->lihatdata();

        $variabel['data'] = $this->m_presensi->lihatdatasatujadwal($id_jadwal)->row_array();
        $this->load->view("back-end/presensi/presensi_kelas/v_jadwal_edit",$variabel);

    }

    function editjadwalafilasiproses()
    {
        $id_jadwal = $this->input->post("idjadwal");

        $idkelasbelajar = $this->input->post("idkelasbelajar");
        $id_pelajaran = $this->input->post("mata_pelajaran");
        $hari = $this->input->post("hari");
        $jam = $this->input->post("jam");

        $array = array (
            "id_mata_pelajaran"=>$id_pelajaran,
            "jam"=>$jam
        );
        if ($id_pelajaran=="Istirahat"){
            $array["mata_pelajaran"]="Istirahat";
            $array["nip"]="Istirahat";
            $array["guru"]="Istirahat";
        } else {
            $data = $this->m_pelajaran->lihatdatasatu($id_pelajaran)->row_array();
            $array["mata_pelajaran"]=$data['nama_mata_pelajaran'];
            $array["nip"]=$data['nip_guru'];
            $array["guru"]=$data['nama_lengkap'];
        }
        $exec = $this->m_presensi->editdatajadwal($id_jadwal,$array);
    }

    function hapusjadwalafilasi()
    {
       $id = $this->input->get("id");
       $idkelas = $this->input->get("idkelas");
       $exec = $this->m_presensi->hapusjadwal($id);
       redirect(base_url()."admin/datamaster/jadwalafilasi?id=".$idkelas."&h=1");
    }

    function pakpondokan(){
        $variabel['data'] = $this->m_pak_pondokan->lihatdata();
        $this->layout->render('back-end/datamaster/pakpondokan/v_pak',$variabel,'back-end/datamaster/pakpondokan/v_pak_js');
    }



     function pakpondokantambah()
    {
        if ($this->input->post()){
                $array=array(
                    'pak'=> $this->input->post('pak'),
                    'jam'=> $this->input->post('jam')
                    );
                $exec = $this->m_pak_pondokan->tambahdata($array);
                if ($exec) redirect(base_url("admin/datamaster/pakpondokantambah?msg=1"));
                else redirect(base_url("admin/datamaster/pakpondokantambah?msg=0"));
        } else {
            $variabel ='';
            $this->layout->render('back-end/datamaster/pakpondokan/v_pak_tambah',$variabel,'back-end/datamaster/pakpondokan/v_pak_js');
        }
    }

    function pakpondokanedit()
    {
        if ($this->input->post()) {
            $kode = $this->input->post('id');
            $array=array(
                'pak'=> $this->input->post('pak'),
                'jam'=> $this->input->post('jam')
                );

                $exec = $this->m_pak_pondokan->editdata($kode,$array);
                if ($exec)
                     redirect(base_url("admin/datamaster/pakpondokanedit?id=".$kode."&msg=1"));
                else
                     redirect(base_url("admin/datamaster/pakpondokanedit?id=".$kode."&msg=0"));
        }
        else{
            $kode = $this->input->get("id");
            $exec = $this->m_pak_pondokan->lihatdatasatu($kode);
            if ($exec->num_rows()>0){
                    $variabel['data'] = $exec ->row_array();
                    $this->layout->render('back-end/datamaster/pakpondokan/v_pak_edit',$variabel,'back-end/datamaster/pakpondokan/v_pak_js');
            }
            else
                redirect(base_url("admin/datamaster/pakpondokan"));
        }
    }

    function pakpondokanhapus()
    {
       $kode = $this->input->get("id");
       $exec = $this->m_pak_pondokan->hapus($kode);
       redirect(base_url()."admin/datamaster/pakpondokan?msg=1");
    }




function pakafilasi(){
    $variabel['data'] = $this->m_pak_afilasi->lihatdata();
    $this->layout->render('back-end/datamaster/pakafilasi/v_pak',$variabel,'back-end/datamaster/pakafilasi/v_pak_js');
}

 function pakafilasitambah()
{
    if ($this->input->post()){
            $array=array(
                'pak'=> $this->input->post('pak'),
                'jam'=> $this->input->post('jam')
                );
            $exec = $this->m_pak_afilasi->tambahdata($array);
            if ($exec) redirect(base_url("admin/datamaster/pakafilasitambah?msg=1"));
            else redirect(base_url("admin/datamaster/pakafilasitambah?msg=0"));
    } else {
        $variabel ='';
        $this->layout->render('back-end/datamaster/pakafilasi/v_pak_tambah',$variabel,'back-end/datamaster/pakafilasi/v_pak_js');
    }
}

function pakafilasiedit()
{
    if ($this->input->post()) {
        $kode = $this->input->post('id');
        $array=array(
            'pak'=> $this->input->post('pak'),
            'jam'=> $this->input->post('jam')
            );

            $exec = $this->m_pak_afilasi->editdata($kode,$array);
            if ($exec)
                 redirect(base_url("admin/datamaster/pakafilasiedit?id=".$kode."&msg=1"));
            else
                 redirect(base_url("admin/datamaster/pakafilasiedit?id=".$kode."&msg=0"));
    }
    else{
        $kode = $this->input->get("id");
        $exec = $this->m_pak_afilasi->lihatdatasatu($kode);
        if ($exec->num_rows()>0){
                $variabel['data'] = $exec ->row_array();
                $this->layout->render('back-end/datamaster/pakafilasi/v_pak_edit',$variabel,'back-end/datamaster/pakafilasi/v_pak_js');
        }
        else
            redirect(base_url("admin/datamaster/pakafilasi"));
    }
}

    function pakafilasihapus()
    {
    $kode = $this->input->get("id");
    $exec = $this->m_pak_afilasi->hapus($kode);
    redirect(base_url()."admin/datamaster/pakafilasi?msg=1");
    }


/////akun ortu santri/////////////

function dataakunortu(){
  $variabel['data'] = $this->m_akun_ortu->lihatdata();
  $this->layout->render('back-end/datamaster/ortu/v_akun_ortu',$variabel,'back-end//datamaster/ortu/v_akun_ortu_js');
}

function buatakunortu(){
  $array= array(
    'id_ortu' => $this->input->post('id'),
    'kata_sandi' => $this->input->post('sandi'),
    'email_ortu' => $this->input->post('email'),
    'status_akun' => 'aktif'
  );
  $exec = $this->m_akun_ortu->tambahdata($array);
  redirect(base_url()."admin/datamaster/dataakunortu?msg=1");
}

function akunortuaktif(){
  $array = array(
    'status_akun' => 'aktif'
  );
  $id = $this->input->get('id');
  $exec = $this->m_akun_ortu->editdata($id,$array);
  redirect(base_url()."admin/datamaster/dataakunortu?aktif=1");

}

function akunortunonaktif(){
  $array = array(
    'status_akun' => 'tidak aktif'
  );
  $id = $this->input->get('id');
  $exec = $this->m_akun_ortu->editdata($id,$array);
  redirect(base_url()."admin/datamaster/dataakunortu?aktif=0");

}

function resetsandiortu(){
  $id = $this->input->get('id');
  $array = array(
    'kata_sandi' => $id
  );

  $exec = $this->m_akun_ortu->editdata($id,$array);
  redirect(base_url()."admin/datamaster/dataakunortu?reset=1");

}
////////////akhir akun ortu///////////////

////////////////////////informasi ortu///////////////////////////////

function informasi()
{
  $variabel['data'] = $this->m_informasi->lihatpengumuman();
  $this->layout->render('back-end/informasi/v_informasi',$variabel,'back-end/informasi/informasi_js');
}

function tambahinformasi()
{
  if ($this->input->post()){

          $array=array(
              'judul_pengumuman'=> $this->input->post('judul_pengumuman'),
              'isi_pengumuman'=> $this->input->post('isi_pengumuman'),
              'link_pengumuman'=> $this->input->post('link_pengumuman'),
              'tanggal_pengumuman'=>$this->input->post('tanggal_pengumuman')
              );
          $exec = $this->m_informasi->tambahdata($array);
          if ($exec) redirect(base_url("admin/datamaster/tambahinformasi?msg=1"));
          else redirect(base_url("admin/datamaster/tambahinformasi?msg=0"));
  } else {
    $variabel= '';
    $this->layout->render('back-end/informasi/v_tambahinformasi',$variabel,'back-end/informasi/informasi_js');
  }
}


function editinformasi()
{
$id_pengumuman = $this->input->get("idpengumuman");
  if ($this->input->post()){
          $array=array(
              'isi_pengumuman'=> $this->input->post('isi_pengumuman'),
              'judul_pengumuman'=> $this->input->post('judul_pengumuman'),
              'link_pengumuman'=> $this->input->post('link_pengumuman'),
              'tanggal_pengumuman'=>$this->input->post('tanggal_pengumuman')
              );
          $exec = $this->m_informasi->editdata($id_pengumuman,$array);
          if ($exec)redirect(base_url("admin/datamaster/editinformasi?idpengumuman=".$id_pengumuman."&msg=1"));
          else redirect(base_url("admin/datamaster/editinformasi?idpengumuman=".$id_pengumuman."&msg=0"));
  } else {
    $exec =$this->m_informasi->data($id_pengumuman);
    if ($exec->num_rows()>0){
        $variabel['data'] = $exec ->row_array();
        $this->layout->render('back-end/informasi/v_editinformasi',$variabel,'back-end/informasi/informasi_js');
  }
}
}

function deleteinformasi()
{
  $id_pengumuman = $this->input->get("idpengumuman");
  $exec = $this->m_informasi->hapus($id_pengumuman);
  redirect(base_url()."admin/datamaster/informasi?msg=1");
}


function printkelaspondokan(){
    $id = $this->input->get("id");
    $exec = $this->m_presensipondokan->lihatdatasatulengkap($id);
    if ($exec->num_rows()>0) {
        $variabel['jadwal'] = $exec->row_array();
        $variabel['listjadwal'] = $this->m_presensipondokan->lihatjadwal($id);
        $this->layout->render('back-end/presensi/presensi_pondokan/v_presensi_print',$variabel,'back-end/presensi/presensi_pondokan/v_presensi_printjs');
    } else {
        redirect(base_url("admin/datamaster/datakelaspondokan"));
    }
}


function printjadwalpondokan(){
    $id = $this->input->get("id");
    $data = $this->m_presensipondokan->lihatdatasatujadwal($id)->row_array();
    $variabel['data'] = $data;
    $variabel['data2'] =  $this->m_presensipondokan->lihatdatasatulengkap($data['id_kelas_belajar'])->row_array();
    $variabel['santri'] = $this->m_presensipondokan->lihatdatasantri($data['id_kelas_belajar']);
    $this->layout->renderlaporan('back-end/presensi/presensi_pondokan/v_presensi_printjadwal',$variabel,'back-end/presensi/presensi_pondokan/v_presensi_printjadwal_js');
  }


function printkelasafilasi(){
    $id = $this->input->get("id");
    $exec = $this->m_presensi->lihatdatasatulengkap($id);
    if ($exec->num_rows()>0) {
        $variabel['jadwal'] = $exec->row_array();
        $variabel['listjadwal'] = $this->m_presensi->lihatjadwal($id);
        $this->layout->render('back-end/presensi/presensi_kelas/v_presensi_print',$variabel,'back-end/presensi/presensi_kelas/v_presensi_printjs');
    } else {
        redirect(base_url("admin/datamaster/datakelasbelajar"));
    }
}


function printjadwalafilasi(){
    $id = $this->input->get("id");
    $data = $this->m_presensi->lihatdatasatujadwal($id)->row_array();
    $variabel['data'] = $data;
    $variabel['data2'] =  $this->m_presensi->lihatdatasatulengkap($data['id_kelas_belajar'])->row_array();
    $variabel['santri'] = $this->m_presensi->lihatdatasantri($data['id_kelas_belajar']);
    $this->layout->renderlaporan('back-end/presensi/presensi_kelas/v_presensi_printjadwal',$variabel,'back-end/presensi/presensi_kelas/v_presensi_printjadwal_js');
  }

  function cetakkartu(){
    $nis = $this->input->get("nis");

    $exec = $this->m_santri->lihatdatasatu($nis);
    if ($exec->num_rows()>0){
        $this->_generate_barcode($nis,'BCGcode39');
        $variabel['data'] = $exec ->row_array();
        // $variabel['tingkat'] = $this->m_santri->lihattingkatan($nis); ;
        // $variabel['tingkatpondokan'] = $this->m_santri->lihattingkatanpondokan($nis); ;
        $this->load->view('back-end/datamaster/santri/v_santri_kartu',$variabel);
    } else {
        redirect(base_url("admin/datamaster/santri"));
    }

  }
  private function _generate_barcode($sparepart_code, $barcode_type, $scale=6, $fontsize=18, $thickness=30,$dpi=72) {
    // CREATE BARCODE GENERATOR
    // Including all required classes
    require_once( APPPATH . 'libraries/barcodegen/BCGFontFile.php');
    require_once( APPPATH . 'libraries/barcodegen/BCGColor.php');
    require_once( APPPATH . 'libraries/barcodegen/BCGDrawing.php');

    // Including the barcode technology
    // Ini bisa diganti-ganti mau yang 39, ato 128, dll, liat di folder barcodegen
    require_once( APPPATH . 'libraries/barcodegen/BCGcode39.barcode.php');

    // Loading Font
    // kalo mau ganti font, jangan lupa tambahin dulu ke folder font, baru loadnya di sini
    $font = new BCGFontFile(APPPATH . 'libraries/font/Arial.ttf', $fontsize);

    // Text apa yang mau dijadiin barcode, biasanya kode produk
    $text = $sparepart_code;

    // The arguments are R, G, B for color.
    $color_black = new BCGColor(0, 0, 0);
    $color_white = new BCGColor(255, 255, 255);

    $drawException = null;
    try {
        $code = new BCGcode39(); // kalo pake yg code39, klo yg lain mesti disesuaikan
        $code->setScale($scale); // Resolution
        $code->setThickness($thickness); // Thickness
        $code->setForegroundColor($color_black); // Color of bars
        $code->setBackgroundColor($color_white); // Color of spaces
        $code->setFont($font); // Font (or 0)
        $code->parse($text); // Text
    } catch(Exception $exception) {
        $drawException = $exception;
    }

    /* Here is the list of the arguments
    1 - Filename (empty : display on screen)
    2 - Background color */
    $drawing = new BCGDrawing('', $color_white);
    if($drawException) {
        $drawing->drawException($drawException);
    } else {
        $drawing->setDPI($dpi);
        $drawing->setBarcode($code);
        $drawing->draw();
    }
    // ini cuma labeling dari sisi aplikasi saya, penamaan file menjadi png barcode.
    $filename_img_barcode = $sparepart_code .'_'.$barcode_type.'.png';
    // folder untuk menyimpan barcode
    $drawing->setFilename('assets/barcode/'. $filename_img_barcode);
    // proses penyimpanan barcode hasil generate
    $drawing->finish(BCGDrawing::IMG_FORMAT_PNG);

    return $filename_img_barcode;
}




}
